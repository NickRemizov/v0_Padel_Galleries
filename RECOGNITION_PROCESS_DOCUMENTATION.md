# –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –ª–∏—Ü –≤ —Å–∏—Å—Ç–µ–º–µ Galeries

**–í–µ—Ä—Å–∏—è:** 3.4.0  
**–î–∞—Ç–∞:** 31 –æ–∫—Ç—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** –ê–∫—Ç—É–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–∏—Å—Ç–µ–º—ã

---

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-—Å–∏—Å—Ç–µ–º—ã)
2. [–ü—Ä–æ—Ü–µ—Å—Å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è (–ø–æ—à–∞–≥–æ–≤–æ)](#–ø—Ä–æ—Ü–µ—Å—Å-—Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è-–ø–æ—à–∞–≥–æ–≤–æ)
3. [–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è](#—Ç–µ–∫—É—â–∞—è-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è)
4. [–ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–¥–µ–ª–∞—Ç—å/–∏–∑–º–µ–Ω–∏—Ç—å](#—á—Ç–æ-–Ω—É–∂–Ω–æ-–¥–æ–¥–µ–ª–∞—Ç—å–∏–∑–º–µ–Ω–∏—Ç—å)
5. [–ü–æ—ç—Ç–∞–ø–Ω—ã–π –ø–ª–∞–Ω –∏–∑–º–µ–Ω–µ–Ω–∏–π](#–ø–æ—ç—Ç–∞–ø–Ω—ã–π-–ø–ª–∞–Ω-–∏–∑–º–µ–Ω–µ–Ω–∏–π)
6. [–û–ø–∏—Å–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫](#–æ–ø–∏—Å–∞–Ω–∏–µ-–Ω–∞—Å—Ç—Ä–æ–µ–∫)
7. [–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è](#–∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏-–¥–ª—è-–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
8. [–ö–ª—é—á–µ–≤—ã–µ –ø–æ–Ω—è—Ç–∏—è –ø—Ä–æ–µ–∫—Ç–∞](#–∫–ª—é—á–µ–≤—ã–µ-–ø–æ–Ω—è—Ç–∏—è-–ø—Ä–æ–µ–∫—Ç–∞)

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

### –§—Ä–æ–Ω—Ç–µ–Ω–¥ (Next.js 16 + React 19)

**–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**

1. **`gallery-images-manager.tsx`** (v3.18) - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥–∞–ª–µ—Ä–µ–µ–π —Ñ–æ—Ç–æ
   - –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ (drag&drop —Å –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–µ–π –º–µ—Ä—Ü–∞–Ω–∏—è, –∫–Ω–æ–ø–∫–∞)
   - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ —Ñ–æ—Ç–æ (–±–µ–π–¥–∂–∏: NFD, XX/YY, XX%, ‚úì)
   - –ö–Ω–æ–ø–∫–∞ "–†–∞—Å–ø–æ–∑–Ω–∞—Ç—å —Ñ–æ—Ç–æ" (–ø–∞–∫–µ—Ç–Ω–æ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ)
   - –ö–Ω–æ–ø–∫–∞ "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ –ª–∏—Ü–∞" (–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è)
   - ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û:** –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–µ–Ω–¥–µ—Ä–∞ —Å React.memo (–≤–µ—Ä—Å–∏—è 0.5.9)

2. **`auto-recognition-dialog.tsx`** (v3.15) - –î–∏–∞–ª–æ–≥ –ø–∞–∫–µ—Ç–Ω–æ–≥–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
   - –ü—Ä–æ–≥—Ä–µ—Å—Å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ, —É—Å–ø–µ—à–Ω–æ, –æ—à–∏–±–æ–∫)
   - ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û:** –ß–µ–∫–±–æ–∫—Å "–ü—Ä–∏–º–µ–Ω—è—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞" (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∫–ª—é—á–µ–Ω)
   - ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û:** –£—Å—Ç–∞–Ω–æ–≤–∫–∞ `has_been_processed = true` –ø–æ—Å–ª–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è

3. **`unknown-faces-review-dialog.tsx`** - –†–∞–±–æ—Ç–∞ —Å –∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏ –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –ª–∏—Ü
   - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
   - –ò—Å–∫–ª—é—á–µ–Ω–∏–µ —Ñ–æ—Ç–æ –∏–∑ –∫–ª–∞—Å—Ç–µ—Ä–∞
   - –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∏–≥—Ä–æ–∫–∞
   - –í—ã–±–æ—Ä —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞ (–ù–£–ñ–ù–û –î–û–ë–ê–í–ò–¢–¨)
   - –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–∞

4. **`face-tagging-dialog.tsx`** - –†—É—á–Ω–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –æ–¥–Ω–æ–≥–æ —Ñ–æ—Ç–æ
   - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤—Å–µ—Ö –ª–∏—Ü –Ω–∞ —Ñ–æ—Ç–æ
   - –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–∞ –∫–∞–∂–¥–æ–º—É –ª–∏—Ü—É
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å —Ä—É—á–Ω–æ–π –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–µ–π

5. **`add-person-dialog.tsx`** - –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∏–≥—Ä–æ–∫–∞
   - –ü–æ–ª–Ω–∞—è —Ñ–æ—Ä–º–∞ (–∏–º—è, —Ñ–∞–º–∏–ª–∏—è, Telegram, —Å–æ—Ü—Å–µ—Ç–∏, —Ä–µ–π—Ç–∏–Ω–≥)
   - –í—ã–±–æ—Ä –∞–≤–∞—Ç–∞—Ä–∞

6. **`face-training-manager.tsx`** - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
   - ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û:** –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ (blur, size, detection score)
   - –ö–æ–Ω—Ç–µ–∫—Å—Ç–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å (context_weight)
   - –ü–æ—Ä–æ–≥–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è

7. **`face-recognition-details-dialog.tsx`** - –î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ª–∏—Ü–∞—Ö
   - ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û:** –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ `blur_score`
   - ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û:** –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ `distance_to_nearest`
   - ‚ö†Ô∏è **–ß–ê–°–¢–ò–ß–ù–û:** –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ `top_matches` (UI –≥–æ—Ç–æ–≤, –Ω–æ –¥–∞–Ω–Ω—ã–µ –Ω–µ –ø—Ä–∏—Ö–æ–¥—è—Ç —Å –±—ç–∫–µ–Ω–¥–∞)

### –ë—ç–∫–µ–Ω–¥ (FastAPI + Python)

**–û—Å–Ω–æ–≤–Ω—ã–µ –º–æ–¥—É–ª–∏:**

1. **`main.py`** - –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª API
   - –í–µ—Ä—Å–∏—è: 3.2.7
   - –†–æ—É—Ç–µ—Ä—ã: `/detect-faces`, `/recognize-face`, `/training`

2. **`services/face_recognition.py`** - –°–µ—Ä–≤–∏—Å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
   - –ö–ª–∞—Å—Å `FaceRecognitionService`
   - –ú–µ—Ç–æ–¥—ã:
     - `detect_faces()` - –¥–µ—Ç–µ–∫—Ü–∏—è –ª–∏—Ü –Ω–∞ —Ñ–æ—Ç–æ
     - `recognize_face()` - —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –ª–∏—Ü–∞
     - `load_quality_filters()` - –∑–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏–∑ –ë–î
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç InsightFace (–º–æ–¥–µ–ª—å antelopev2)

3. **`services/supabase_client.py`** - –†–∞–±–æ—Ç–∞ —Å –ë–î
   - CRUD –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–ª—è –≤—Å–µ—Ö —Ç–∞–±–ª–∏—Ü
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞–º–∏ –∏ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º–∏
   - –ü–µ—Ä–µ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞ HNSWLIB

4. **`services/training_service.py`** - –û–±—É—á–µ–Ω–∏–µ –∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è
   - –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –ª–∏—Ü (HDBSCAN)
   - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞–º–∏

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (Supabase PostgreSQL)

**–û—Å–Ω–æ–≤–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã:**

1. **`gallery_photos`** - –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏
   - `id`, `gallery_id`, `image_url`, `original_url`, `original_filename`, `created_at`
   - ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û:** `has_been_processed` (boolean, default false) - –¥–æ–±–∞–≤–ª–µ–Ω–æ –≤ –≤–µ—Ä—Å–∏–∏ 0.5.7

2. **`photo_faces`** - –û–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ª–∏—Ü–∞ –Ω–∞ —Ñ–æ—Ç–æ
   - `id`, `photo_id`, `person_id`, `insightface_bbox`, `confidence`, `manually_verified`
   - ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û:** `blur_score` (float) - —Ä–µ–∑–∫–æ—Å—Ç—å –ª–∏—Ü–∞ (—Å–∫—Ä–∏–ø—Ç 050)
   - ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û:** `insightface_det_score` (float) - —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –¥–µ—Ç–µ–∫—Ü–∏–∏ (—Å–∫—Ä–∏–ø—Ç 050)
   - **–ù–£–ñ–ù–û –î–û–ë–ê–í–ò–¢–¨:** `face_category` (enum: 'player', 'trainer', 'spectator', 'unknown', default 'unknown')
   - **–ù–£–ñ–ù–û –î–û–ë–ê–í–ò–¢–¨:** `rejected` (boolean, default false)

3. **`photo_face_descriptors`** - –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã –ª–∏—Ü (512-–º–µ—Ä–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã)
   - `id`, `photo_face_id`, `descriptor`

4. **`people`** - –õ—é–¥–∏ (–∏–≥—Ä–æ–∫–∏, —Ç—Ä–µ–Ω–µ—Ä—ã)
   - `id`, `first_name`, `last_name`, `telegram_username`, `rating`
   - **–ù–£–ñ–ù–û –î–û–ë–ê–í–ò–¢–¨:** `category` (enum: 'player', 'trainer', default 'player')

5. **`face_recognition_config`** - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
   - `key`, `value`, `description`
   - ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û:** `quality_filters` —Å –ø–æ–ª—è–º–∏:
     - `min_face_size` (default: 80)
     - `min_blur_score` (default: 100.0)
     - `min_detection_score` (default: 0.7)
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∏: `context_weight`, `min_confidence_for_gallery` (–ù–£–ñ–ù–û –î–û–ë–ê–í–ò–¢–¨)

**ENUM —Ç–∏–ø—ã (–ù–£–ñ–ù–û –°–û–ó–î–ê–¢–¨):**
\`\`\`sql
CREATE TYPE person_category AS ENUM ('player', 'trainer');
CREATE TYPE face_category AS ENUM ('player', 'trainer', 'spectator', 'unknown');
\`\`\`

---

## –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è (–ø–æ—à–∞–≥–æ–≤–æ)

### –≠—Ç–∞–ø 1: –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ

**–§—Ä–æ–Ω—Ç–µ–Ω–¥:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –≥–∞–ª–µ—Ä–µ—é —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É "Images" üì∑
2. –ó–∞–≥—Ä—É–∂–∞–µ—Ç —Ñ–æ—Ç–æ —á–µ—Ä–µ–∑:
   - –ö–Ω–æ–ø–∫—É "–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ"
   - Drag & Drop (–ø–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤) - ‚úÖ **–û–ü–¢–ò–ú–ò–ó–ò–†–û–í–ê–ù–û** (–≤–µ—Ä—Å–∏—è 0.5.9, –±–µ–∑ –º–µ—Ä—Ü–∞–Ω–∏—è)
3. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è `uploadAction()` –∏–∑ `app/admin/actions.ts`

**–ë—ç–∫–µ–Ω–¥:**
1. –§–æ—Ç–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –≤ Vercel Blob Storage
2. –°–æ–∑–¥–∞–µ—Ç—Å—è –∑–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü–µ `gallery_photos`:
   - `gallery_id` - ID –≥–∞–ª–µ—Ä–µ–∏
   - `image_url` - URL –≤ Blob Storage
   - `has_been_processed` = `false` ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û**

**–°—Ç–∞—Ç—É—Å —Ñ–æ—Ç–æ:** –ë–µ–∑ –±–µ–π–¥–∂–∞ (–Ω–æ–≤–æ–µ, –Ω–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–æ–µ) ‚úÖ **–†–ê–ë–û–¢–ê–ï–¢**

---

### –≠—Ç–∞–ø 2: –ü–∞–∫–µ—Ç–Ω–æ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ

**–§—Ä–æ–Ω—Ç–µ–Ω–¥:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É "–†–∞—Å–ø–æ–∑–Ω–∞—Ç—å —Ñ–æ—Ç–æ" üîç
2. ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û:** –ß–µ–∫–±–æ–∫—Å "–ü—Ä–∏–º–µ–Ω—è—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞" (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∫–ª—é—á–µ–Ω)
3. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥ `AutoRecognitionDialog`
4. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–æ—Ç–æ –±–µ–∑ —Ä—É—á–Ω–æ–π –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏:
   - –í—ã–∑—ã–≤–∞–µ—Ç—Å—è `/api/face-detection/detect` (Next.js proxy ‚Üí FastAPI `/detect-faces`)
   - –î–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–æ–≥–æ –ª–∏—Ü–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `/api/face-detection/recognize` (Next.js proxy ‚Üí FastAPI `/recognize-face`)

**–ë—ç–∫–µ–Ω–¥:**

#### 2.1. –î–µ—Ç–µ–∫—Ü–∏—è –ª–∏—Ü (`/detect-faces`)

**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- `image_url` - URL —Ñ–æ—Ç–æ
- `apply_quality_filters` - –ø—Ä–∏–º–µ–Ω—è—Ç—å –ª–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û**

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ –ø–æ URL
2. –î–µ—Ç–µ–∫—Ü–∏—è –ª–∏—Ü —á–µ—Ä–µ–∑ InsightFace (`app.get()`)
3. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–æ–≥–æ –ª–∏—Ü–∞:
   - –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ bbox (–∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã)
   - –í—ã—á–∏—Å–ª–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –ª–∏—Ü–∞
   - ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û:** –í—ã—á–∏—Å–ª–µ–Ω–∏–µ `blur_score` (—Ä–µ–∑–∫–æ—Å—Ç—å, Laplacian variance)
   - ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û:** –í—ã—á–∏—Å–ª–µ–Ω–∏–µ `insightface_det_score` (—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –¥–µ—Ç–µ–∫—Ü–∏–∏)

4. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è (–µ—Å–ª–∏ `apply_quality_filters=true`):** ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û**
   - –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏–∑ –ë–î —á–µ—Ä–µ–∑ `load_quality_filters()`
   - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ:
     - `min_face_size` (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ª–∏—Ü–∞ –≤ –ø–∏–∫—Å–µ–ª—è—Ö)
     - `min_blur_score` (–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ä–µ–∑–∫–æ—Å—Ç—å)
     - `min_detection_score` (–º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –¥–µ—Ç–µ–∫—Ü–∏–∏)
   - –õ–∏—Ü–∞, –Ω–µ –ø—Ä–æ—à–µ–¥—à–∏–µ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é, –æ—Ç–±—Ä–∞—Å—ã–≤–∞—é—Ç—Å—è

5. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ—à–µ–¥—à–µ–≥–æ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ª–∏—Ü–∞:
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è 512-–º–µ—Ä–Ω–æ–≥–æ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞ (–¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞)
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –ë–î:
     - `photo_faces`: `photo_id`, `insightface_bbox`, `confidence=insightface_det_score`, `blur_score`, `insightface_det_score`
     - `photo_face_descriptors`: `photo_face_id`, `descriptor`

6. ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û:** –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `gallery_photos.has_been_processed = true` (–≤–µ—Ä—Å–∏—è 0.5.7)

**–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- –°–ø–∏—Å–æ–∫ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö –ª–∏—Ü —Å –∏—Ö ID, bbox, —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º–∏

#### 2.2. –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –ª–∏—Ü–∞ (`/recognize-face`)

**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- `embedding` - 512-–º–µ—Ä–Ω—ã–π –≤–µ–∫—Ç–æ—Ä –ª–∏—Ü–∞
- **–ù–£–ñ–ù–û –î–û–ë–ê–í–ò–¢–¨ –¥–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞:**
  - `photo_id` - ID —Ñ–æ—Ç–æ (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥—Ä—É–≥–∏—Ö –ª–∏—Ü –Ω–∞ —ç—Ç–æ–º —Ñ–æ—Ç–æ)
  - `gallery_id` - ID –≥–∞–ª–µ—Ä–µ–∏ (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ co-occurrence)

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ó–∞–≥—Ä—É–∑–∫–∞ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞ –ª–∏—Ü–∞ –∏–∑ –∑–∞–ø—Ä–æ—Å–∞
2. –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —ç–º–±–µ–¥–¥–∏–Ω–≥–æ–≤ –∏–∑ –ë–î
3. –ü–æ–∏—Å–∫ –ø–æ—Ö–æ–∂–∏—Ö –ª–∏—Ü:
   - **Verified faces** (–ø–æ—Ä–æ–≥ 0.6): –ü–æ–∏—Å–∫ —Å—Ä–µ–¥–∏ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ª–∏—Ü
   - **Unverified faces** (–ø–æ—Ä–æ–≥ 0.75): –ü–æ–∏—Å–∫ –≤ –∏–Ω–¥–µ–∫—Å–µ HNSWLIB

4. **–ù–£–ñ–ù–û –î–û–ë–ê–í–ò–¢–¨:** –£—á–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
   - –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω—ã —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è, –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:
     - –ï—Å—Ç—å –ª–∏ —ç—Ç–æ—Ç –∏–≥—Ä–æ–∫ –Ω–∞ –¥—Ä—É–≥–∏—Ö –ª–∏—Ü–∞—Ö —ç—Ç–æ–≥–æ —Ñ–æ—Ç–æ? (photo_id)
     - –ï—Å—Ç—å –ª–∏ —ç—Ç–æ—Ç –∏–≥—Ä–æ–∫ –Ω–∞ –¥—Ä—É–≥–∏—Ö —Ñ–æ—Ç–æ —ç—Ç–æ–π –≥–∞–ª–µ—Ä–µ–∏? (gallery_id)
   - –ü–æ–≤—ã—Å–∏—Ç—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –Ω–∞ `context_weight` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0.1)

5. –í—ã–±–æ—Ä –ª—É—á—à–µ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è:
   - –ï—Å–ª–∏ `confidence >= –ø–æ—Ä–æ–≥` - –ø—Ä–∏—Å–≤–æ–∏—Ç—å `person_id`
   - –ï—Å–ª–∏ `confidence < –ø–æ—Ä–æ–≥` - –æ—Å—Ç–∞–≤–∏—Ç—å `person_id = null` (–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ –ª–∏—Ü–æ)

6. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `photo_faces`:
   - `person_id` (–µ—Å–ª–∏ –Ω–∞–π–¥–µ–Ω–æ)
   - `confidence` (—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è)
   - `manually_verified = false` (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ)

**–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- `person_id` (–∏–ª–∏ null)
- `confidence` (—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å)
- **–ù–£–ñ–ù–û –î–û–ë–ê–í–ò–¢–¨:** `top_matches` (—Ç–æ–ø-3 –ø–æ—Ö–æ–∂–∏—Ö –ª–∏—Ü —Å –∏–º–µ–Ω–∞–º–∏ –∏ similarity)

---

### –≠—Ç–∞–ø 3: –°—Ç–∞—Ç—É—Å—ã —Ñ–æ—Ç–æ –ø–æ—Å–ª–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è

**–ë–µ–π–¥–∂–∏ –Ω–∞ —Ñ–æ—Ç–æ:**

1. **–ë–µ–∑ –±–µ–π–¥–∂–∞** - –ù–æ–≤–æ–µ —Ñ–æ—Ç–æ, –Ω–µ –ø—Ä–æ—Ö–æ–¥–∏–ª–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ
   - `has_been_processed = false`
   - ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û** (–≤–µ—Ä—Å–∏—è 0.5.9)

2. **NFD** (No Faces Detected) - –õ–∏—Ü–∞ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã
   - `has_been_processed = true`
   - –ù–µ—Ç –∑–∞–ø–∏—Å–µ–π –≤ `photo_faces` –ò–õ–ò –≤—Å–µ –ª–∏—Ü–∞ –æ—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω—ã –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏ –∫–∞—á–µ—Å—Ç–≤–∞
   - ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û** (–≤–µ—Ä—Å–∏—è 0.5.7)

3. **XX/YY** - XX –Ω–µ–æ–ø–æ–∑–Ω–∞–Ω–Ω—ã—Ö –ª–∏—Ü –∏–∑ YY –≤—Å–µ–≥–æ –ª–∏—Ü
   - XX = –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∏—Ü —Å `person_id = null` –∏ `face_category != 'spectator'`
   - YY = –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ª–∏—Ü
   - –ü—Ä–∏–º–µ—Ä: "2/4" - 2 –Ω–µ–æ–ø–æ–∑–Ω–∞–Ω–Ω—ã—Ö –∏–∑ 4 –ª–∏—Ü
   - ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û** (–≤–µ—Ä—Å–∏—è 0.5.6)

4. **XX%** - –ü—Ä–æ—Ü–µ–Ω—Ç —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ (–Ω–æ –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ)
   - –ï—Å—Ç—å –ª–∏—Ü–∞ —Å `person_id != null` –∏ `manually_verified = false`
   - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å —Å—Ä–µ–¥–∏ –≤—Å–µ—Ö –ª–∏—Ü
   - –ü—Ä–∏–º–µ—Ä: "75%" - –º–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å 75%
   - ‚úÖ **–†–ê–ë–û–¢–ê–ï–¢**

5. **‚úì** (Verified) - –í—Å–µ –ª–∏—Ü–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω—ã –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω—ã
   - –í—Å–µ –ª–∏—Ü–∞ –∏–º–µ—é—Ç `person_id != null`
   - –í—Å–µ –ª–∏—Ü–∞ –∏–º–µ—é—Ç `manually_verified = true` –ò–õ–ò `confidence = 1.0`
   - ‚úÖ **–†–ê–ë–û–¢–ê–ï–¢**

---

### –≠—Ç–∞–ø 4: –†–∞–±–æ—Ç–∞ —Å –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–º–∏ –ª–∏—Ü–∞–º–∏

**–§—Ä–æ–Ω—Ç–µ–Ω–¥:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç –∫–Ω–æ–ø–∫—É "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ –ª–∏—Ü–∞" üë§+
2. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥ `UnknownFacesReviewDialog`
3. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è `/training/cluster-unverified-faces` –¥–ª—è –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏

**–ë—ç–∫–µ–Ω–¥:**

#### 4.1. –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è (`/training/cluster-unverified-faces`)

**–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- `gallery_id` - ID –≥–∞–ª–µ—Ä–µ–∏

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –ª–∏—Ü –∏–∑ –≥–∞–ª–µ—Ä–µ–∏:
   - `person_id = null`
   - `is_spectator = false`
   - –ï—Å—Ç—å –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –≤ `photo_face_descriptors`

2. –ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ HDBSCAN:
   - –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ—Ö–æ–∂–∏—Ö –ª–∏—Ü –ø–æ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞–º
   - –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: `min_cluster_size=2`, `min_samples=1`, `metric='cosine'`

3. –°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –ø–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É —Ñ–æ—Ç–æ (–æ—Ç –±–æ–ª—å—à–µ–≥–æ –∫ –º–µ–Ω—å—à–µ–º—É)

**–í—ã—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ:**
- –°–ø–∏—Å–æ–∫ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ —Å —Ñ–æ—Ç–æ

**–§—Ä–æ–Ω—Ç–µ–Ω–¥:**
1. –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –ø–æ –æ–¥–Ω–æ–º—É
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è:
   - –°–µ—Ç–∫–∞ —Ñ–æ—Ç–æ —Å —Å–∏–Ω–∏–º–∏ —Ä–∞–º–∫–∞–º–∏ –≤–æ–∫—Ä—É–≥ –ª–∏—Ü
   - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: "–í—Å–µ–≥–æ —Ñ–æ—Ç–æ: X | –ê–∫—Ç–∏–≤–Ω—ã—Ö: Y | –ò—Å–∫–ª—é—á–µ–Ω–æ: Z"
   - –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π

---

### –≠—Ç–∞–ø 5: –î–µ–π—Å—Ç–≤–∏—è —Å –∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏

#### 5.1. –ò—Å–∫–ª—é—á–µ–Ω–∏–µ —Ñ–æ—Ç–æ –∏–∑ –∫–ª–∞—Å—Ç–µ—Ä–∞

**–ö–Ω–æ–ø–∫–∞ "X"** –Ω–∞ –∫–∞–∂–¥–æ–º —Ñ–æ—Ç–æ (–∫—Ä–∞—Å–Ω—ã–π –∫—Ä–µ—Å—Ç–∏–∫)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ò—Å–∫–ª—é—á–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —Ñ–æ—Ç–æ –∏–∑ –∫–ª–∞—Å—Ç–µ—Ä–∞ (–µ—Å–ª–∏ AI –æ—à–∏–±—Å—è)

**–ü—Ä–æ—Ü–µ—Å—Å:**
1. –§–æ—Ç–æ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –ø–æ–ª—É–ø—Ä–æ–∑—Ä–∞—á–Ω—ã–º —Å –∫—Ä–∞—Å–Ω–æ–π —Ä–∞–º–∫–æ–π
2. –ù–∞–¥–ø–∏—Å—å "–ò—Å–∫–ª—é—á–µ–Ω–æ"
3. –ù–µ —É—á–∞—Å—Ç–≤—É–µ—Ç –≤ –¥–∞–ª—å–Ω–µ–π—à–∏—Ö –¥–µ–π—Å—Ç–≤–∏—è—Ö
4. –ú–æ–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å, –Ω–∞–∂–∞–≤ X –µ—â–µ —Ä–∞–∑

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:** –õ–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ, –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ –ë–î

---

#### 5.2. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∏–≥—Ä–æ–∫–∞

**–ö–Ω–æ–ø–∫–∞ "–°–æ–∑–¥–∞—Ç—å –∏–≥—Ä–æ–∫–∞"** (—á–µ—Ä–Ω–∞—è, —Å –∏–∫–æ–Ω–∫–æ–π UserPlus)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –∏–≥—Ä–æ–∫–∞ –∏ –ø—Ä–∏—Å–≤–æ–∏—Ç—å –µ–º—É –≤—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ —Ñ–æ—Ç–æ –∏–∑ –∫–ª–∞—Å—Ç–µ—Ä–∞

**–ü—Ä–æ—Ü–µ—Å—Å:**

**–§—Ä–æ–Ω—Ç–µ–Ω–¥:**
1. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥ `AddPersonDialog`
2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø–æ–ª–Ω—è–µ—Ç –ø–æ–ª—è:
   - –ò–º—è, –§–∞–º–∏–ª–∏—è
   - Telegram username
   - Instagram, VK
   - –†–µ–π—Ç–∏–Ω–≥
   - –ê–≤–∞—Ç–∞—Ä
3. –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è callback —Å `person_id`
4. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è `assignClusterToPersonAction()` –¥–ª—è –ø—Ä–∏—Å–≤–æ–µ–Ω–∏—è —Ñ–æ—Ç–æ

**–ë—ç–∫–µ–Ω–¥:**
1. –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ `people`
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ñ–æ—Ç–æ –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ:
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `photo_faces`:
     - `person_id` = ID —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –∏–≥—Ä–æ–∫–∞
     - `confidence` = 1.0 (100%)
     - `manually_verified` = –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç—Å—è –ø–æ –ª–æ–≥–∏–∫–µ (—Å–º. –Ω–∏–∂–µ)

**–õ–æ–≥–∏–∫–∞ `manually_verified`:**
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–æ—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è:
  - –ï—Å–ª–∏ –Ω–∞ —Ñ–æ—Ç–æ —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ –ª–∏—Ü–æ (—ç—Ç–æ –ª–∏—Ü–æ –∏–∑ –∫–ª–∞—Å—Ç–µ—Ä–∞) ‚Üí `manually_verified = true`
  - –ï—Å–ª–∏ –Ω–∞ —Ñ–æ—Ç–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ª–∏—Ü:
    - –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤—Å–µ –ª–∏—Ü–∞ —ç—Ç–æ–≥–æ —Ñ–æ—Ç–æ
    - –ï—Å–ª–∏ –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –ª–∏—Ü–∞ –∏–º–µ—é—Ç `manually_verified = true` –ò–õ–ò `confidence = 1.0` ‚Üí `manually_verified = true`
    - –ò–Ω–∞—á–µ ‚Üí `manually_verified = false`

**–ù–£–ñ–ù–û –ò–°–ü–†–ê–í–ò–¢–¨:** –°–µ–π—á–∞—Å –ø—Ä–∏—Å–≤–æ–µ–Ω–∏–µ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

---

#### 5.3. –í—ã–±–æ—Ä —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞

**–ö–Ω–æ–ø–∫–∞ "–í—ã–±—Ä–∞—Ç—å –∏–≥—Ä–æ–∫–∞"** (–ù–£–ñ–ù–û –î–û–ë–ê–í–ò–¢–¨)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü—Ä–∏—Å–≤–æ–∏—Ç—å –∫–ª–∞—Å—Ç–µ—Ä —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º—É –∏–≥—Ä–æ–∫—É

**–ü—Ä–æ—Ü–µ—Å—Å:**

**–§—Ä–æ–Ω—Ç–µ–Ω–¥:**
1. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å–µ–ª–µ–∫—Ç–æ—Ä –∏–≥—Ä–æ–∫–æ–≤ (Combobox)
2. –ü–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏/—Ñ–∞–º–∏–ª–∏–∏
3. –í—ã–±–æ—Ä –∏–≥—Ä–æ–∫–∞
4. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è `assignClusterToPersonAction()` —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º `person_id`

**–ë—ç–∫–µ–Ω–¥:**
- –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Å–æ–∑–¥–∞–Ω–∏—é –Ω–æ–≤–æ–≥–æ –∏–≥—Ä–æ–∫–∞, –Ω–æ –±–µ–∑ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–∏ –≤ `people`

---

#### 5.4. –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ —Ñ–æ—Ç–æ –∏ –∑—Ä–∏—Ç–µ–ª–∏

**–ö–Ω–æ–ø–∫–∞ "X" –Ω–∞ –∫–∞–∂–¥–æ–º —Ñ–æ—Ç–æ** (–∫—Ä–∞—Å–Ω—ã–π –∫—Ä–µ—Å—Ç–∏–∫)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –û—Ç–∫–ª–æ–Ω–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —Ñ–æ—Ç–æ (–ø–æ–º–µ—Ç–∏—Ç—å –∫–∞–∫ rejected)

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –û—à–∏–±–∫–∏ –¥–µ—Ç–µ–∫—Ü–∏–∏ (–Ω–µ –ª–∏—Ü–∞)
- –ü–ª–æ—Ö–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ (—Ä–∞–∑–º—ã—Ç—ã–µ, –∑–∞–∫—Ä—ã—Ç—ã–µ –ª–∏—Ü–∞)
- –ú—É—Å–æ—Ä–Ω—ã–µ —ç–º–±–µ–¥–¥–∏–Ω–≥–∏

**–ü—Ä–æ—Ü–µ—Å—Å:**

**–§—Ä–æ–Ω—Ç–µ–Ω–¥:**
1. –ù–∞–∂–∞—Ç–∏–µ "X" –Ω–∞ —Ñ–æ—Ç–æ
2. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ: "–û—Ç–∫–ª–æ–Ω–∏—Ç—å —ç—Ç–æ —Ñ–æ—Ç–æ?"
3. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è `rejectPhotoAction(photo_face_id)`

**–ë—ç–∫–µ–Ω–¥:**
1. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `photo_faces`:
   - `rejected = true` (–ù–£–ñ–ù–û –î–û–ë–ê–í–ò–¢–¨ –ø–æ–ª–µ)
   - `face_category = 'unknown'`
2. –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ `photo_face_descriptors`
3. –ü–µ—Ä–µ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞

**–ö–Ω–æ–ø–∫–∞ "–ó—Ä–∏—Ç–µ–ª–∏"** (–¥–ª—è –≤—Å–µ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–º–µ—Ç–∏—Ç—å –≤–µ—Å—å –∫–ª–∞—Å—Ç–µ—Ä –∫–∞–∫ –∑—Ä–∏—Ç–µ–ª–µ–π

**–ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:**
- –†–µ–∞–ª—å–Ω—ã–µ –∑—Ä–∏—Ç–µ–ª–∏ –Ω–∞ —Ñ–æ—Ç–æ
- –õ—é–¥–∏, –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –≤ –±–∞–∑–µ –∏–≥—Ä–æ–∫–æ–≤
- –ù–µ –º–µ—à–∞—é—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—é

**–ü—Ä–æ—Ü–µ—Å—Å:**

**–§—Ä–æ–Ω—Ç–µ–Ω–¥:**
1. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ: "–ü–æ–º–µ—Ç–∏—Ç—å N —Ñ–æ—Ç–æ –∫–∞–∫ –∑—Ä–∏—Ç–µ–ª–µ–π?"
2. –í—ã–∑—ã–≤–∞–µ—Ç—Å—è `markClusterAsSpectatorsAction()`

**–ë—ç–∫–µ–Ω–¥:**
1. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ñ–æ—Ç–æ –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ:
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ `photo_faces`:
     - `face_category = 'spectator'`
     - `person_id = NULL` (–∑—Ä–∏—Ç–µ–ª–∏ –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ `people`)
   - –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ `photo_face_descriptors` (—ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –Ω–µ –Ω—É–∂–Ω—ã)
2. –ü–µ—Ä–µ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞

**–í–∞–∂–Ω–æ:** 
- –ó—Ä–∏—Ç–µ–ª–∏ –ù–ï —Å–æ–∑–¥–∞—é—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ `people`
- –ó—Ä–∏—Ç–µ–ª–∏ –ù–ï —É—á–∞—Å—Ç–≤—É—é—Ç –≤ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–∏ –∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏
- –≠–º–±–µ–¥–¥–∏–Ω–≥–∏ –∑—Ä–∏—Ç–µ–ª–µ–π –ù–ï —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è

**–õ–æ–≥–∏–∫–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π:**
- –ï—Å–ª–∏ `person_id` –ø—Ä–∏—Å–≤–æ–µ–Ω ‚Üí `face_category` –±–µ—Ä–µ—Ç—Å—è –∏–∑ `people.category` ('player' –∏–ª–∏ 'trainer')
- –ï—Å–ª–∏ `person_id = NULL` –∏ –ø–æ–º–µ—á–µ–Ω –∫–∞–∫ –∑—Ä–∏—Ç–µ–ª—å ‚Üí `face_category = 'spectator'`
- –ï—Å–ª–∏ `person_id = NULL` –∏ –Ω–µ –ø–æ–º–µ—á–µ–Ω ‚Üí `face_category = 'unknown'`

---

#### 5.5. –£–¥–∞–ª–∏—Ç—å –∫–Ω–æ–ø–∫—É "–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å"

**–£–î–ê–õ–ï–ù–û:** –ö–Ω–æ–ø–∫–∞ "–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å" –¥—É–±–ª–∏—Ä—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∫–Ω–æ–ø–∫–∏ "–°–ª–µ–¥—É—é—â–∏–π"

**–ò—Ç–æ–≥–æ–≤—ã–µ –∫–Ω–æ–ø–∫–∏ –≤ –¥–∏–∞–ª–æ–≥–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤:**
1. **"–°–æ–∑–¥–∞—Ç—å –∏–≥—Ä–æ–∫–∞"** - —Å–æ–∑–¥–∞—Ç—å –Ω–æ–≤–æ–≥–æ –∏–≥—Ä–æ–∫–∞ –∏ –ø—Ä–∏—Å–≤–æ–∏—Ç—å –∫–ª–∞—Å—Ç–µ—Ä
2. **"–í—ã–±—Ä–∞—Ç—å –∏–≥—Ä–æ–∫–∞"** - –≤—ã–±—Ä–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞ –∏ –ø—Ä–∏—Å–≤–æ–∏—Ç—å –∫–ª–∞—Å—Ç–µ—Ä
3. **"–ó—Ä–∏—Ç–µ–ª–∏"** - –ø–æ–º–µ—Ç–∏—Ç—å –≤–µ—Å—å –∫–ª–∞—Å—Ç–µ—Ä –∫–∞–∫ –∑—Ä–∏—Ç–µ–ª–∏
4. **"X" –Ω–∞ –∫–∞–∂–¥–æ–º —Ñ–æ—Ç–æ** - –æ—Ç–∫–ª–æ–Ω–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ —Ñ–æ—Ç–æ

**–ù–∞–≤–∏–≥–∞—Ü–∏—è (–≤–Ω–∏–∑—É):**
- **"–ü—Ä–µ–¥—ã–¥—É—â–∏–π"** - –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É –∫–ª–∞—Å—Ç–µ—Ä—É
- **"–°–ª–µ–¥—É—é—â–∏–π"** - –ø–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –∫–ª–∞—Å—Ç–µ—Ä—É

---

#### 5.6. –ï–¥–∏–Ω–∏—á–Ω—ã–µ —Ñ–æ—Ç–æ –≤ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏

**–ù–£–ñ–ù–û –î–û–ë–ê–í–ò–¢–¨:** –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –µ–¥–∏–Ω–∏—á–Ω—ã–µ —Ñ–æ—Ç–æ –∫–∞–∫ –∫–ª–∞—Å—Ç–µ—Ä—ã —Ä–∞–∑–º–µ—Ä–æ–º 1

**–õ–æ–≥–∏–∫–∞:**
- –ß–µ–ª–æ–≤–µ–∫ –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–æ–ª—å–∫–æ –Ω–∞ –æ–¥–Ω–æ–º —Ñ–æ—Ç–æ —Ç—É—Ä–Ω–∏—Ä–∞
- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É –Ω—É–∂–Ω–æ —Ä–∞–∑–º–µ—Ç–∏—Ç—å –í–°–ï –æ–ø–æ–∑–Ω–∞–Ω–Ω—ã–µ –ª–∏—Ü–∞
- –ù–∞—á–∏–Ω–∞—Ç—å —Å –±–æ–ª—å—à–∏—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤, –∑–∞–∫–∞–Ω—á–∏–≤–∞—Ç—å –µ–¥–∏–Ω–∏—á–Ω—ã–º–∏

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
1. HDBSCAN –ø–æ–º–µ—á–∞–µ—Ç –µ–¥–∏–Ω–∏—á–Ω—ã–µ –ª–∏—Ü–∞ –∫–∞–∫ "—à—É–º" (label=-1)
2. –î–æ–±–∞–≤–∏—Ç—å –∏—Ö –≤ —Å–ø–∏—Å–æ–∫ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤ –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∫–ª–∞—Å—Ç–µ—Ä—ã —Ä–∞–∑–º–µ—Ä–æ–º 1
3. –°–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –∫–ª–∞—Å—Ç–µ—Ä—ã –ø–æ —Ä–∞–∑–º–µ—Ä—É (–æ—Ç –±–æ–ª—å—à–µ–≥–æ –∫ –º–µ–Ω—å—à–µ–º—É)

**–ò–Ω–¥–∏–∫–∞—Ç–æ—Ä:** "–ö–ª–∞—Å—Ç–µ—Ä X –∏–∑ Y (Z —Ñ–æ—Ç–æ)" - –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä –∫–ª–∞—Å—Ç–µ—Ä–∞

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –§–∏–ª—å—Ç—Ä "–¢–æ–ª—å–∫–æ –∫–ª–∞—Å—Ç–µ—Ä—ã > 1" –Ω–µ –Ω—É–∂–µ–Ω - –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –ø—Ä–æ—Å—Ç–æ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å—Å—è –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –±–æ–ª—å—à–∏—Ö –∫–ª–∞—Å—Ç–µ—Ä–æ–≤

---

### –≠—Ç–∞–ø 6: –†—É—á–Ω–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è –æ–¥–Ω–æ–≥–æ —Ñ–æ—Ç–æ

**–§—Ä–æ–Ω—Ç–µ–Ω–¥:**
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∫–ª–∏–∫–∞–µ—Ç –Ω–∞ —Ñ–æ—Ç–æ –≤ –≥–∞–ª–µ—Ä–µ–µ
2. –û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥ `FaceTaggingDialog`

**–¢–µ–∫—É—â–µ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
- –í—Å–µ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è `/detect-faces` –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è

**–ù–£–ñ–ù–û –ò–ó–ú–ï–ù–ò–¢–¨:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –µ—Å—Ç—å –ª–∏ —É–∂–µ –∑–∞–ø–∏—Å–∏ –≤ `photo_faces` –¥–ª—è —ç—Ç–æ–≥–æ —Ñ–æ—Ç–æ
2. –ï—Å–ª–∏ –µ—Å—Ç—å - –ø–æ–∫–∞–∑–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ–≥–∏, –ù–ï —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å –∑–∞–Ω–æ–≤–æ
3. –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É "–†–∞—Å–ø–æ–∑–Ω–∞—Ç—å –∑–∞–Ω–æ–≤–æ –±–µ–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫":
   - –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∑–∞–ø–∏—Å–∏ –∏–∑ `photo_faces` –∏ `photo_face_descriptors`
   - –í—ã–∑–≤–∞—Ç—å `/detect-faces` —Å `apply_quality_filters=false`
   - –ü–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–∏

**–î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–∏:**

–ü–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è "–†–∞—Å–ø–æ–∑–Ω–∞—Ç—å –∑–∞–Ω–æ–≤–æ –±–µ–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫" –ø–æ–∫–∞–∑–∞—Ç—å –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –∫–∞–∂–¥–æ–º –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω–æ–º –ª–∏—Ü–µ:

**–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ª–∏—Ü–µ:**
- **–†–∞–∑–º–µ—Ä –ª–∏—Ü–∞:** XX px (—à–∏—Ä–∏–Ω–∞ bbox)
- **Blur score:** XX.X (—Ä–µ–∑–∫–æ—Å—Ç—å)
- **Detection score:** 0.XX (—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å —á—Ç–æ —ç—Ç–æ –ª–∏—Ü–æ)
- **Recognition confidence:** 0.XX (—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è, –µ—Å–ª–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ)
- **–ö–∞—á–µ—Å—Ç–≤–æ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞:** XX.X (–Ω–æ—Ä–º–∞ –≤–µ–∫—Ç–æ—Ä–∞)
- **–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –±–ª–∏–∂–∞–π—à–µ–≥–æ –∏–∑–≤–µ—Å—Ç–Ω–æ–≥–æ –ª–∏—Ü–∞:** 0.XX
- **–¢–æ–ø-3 –ø–æ—Ö–æ–∂–∏—Ö –ª–∏—Ü:**
  1. –ò–º—è –§–∞–º–∏–ª–∏—è (similarity: 0.XX)
  2. –ò–º—è –§–∞–º–∏–ª–∏—è (similarity: 0.XX)
  3. –ò–º—è –§–∞–º–∏–ª–∏—è (similarity: 0.XX)

**–ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã bbox:** –£–∂–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –Ω–∞ —Ñ–æ—Ç–æ (—Å–∏–Ω—è—è —Ä–∞–º–∫–∞)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –ü–æ–º–æ–≥–∞–µ—Ç –ø–æ–Ω—è—Ç—å, –ø–æ—á–µ–º—É –ª–∏—Ü–æ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ –∏–ª–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ

---

### –≠—Ç–∞–ø 7: –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –≥–∞–ª–µ—Ä–µ–∏

**–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ñ–æ—Ç–æ –∏–≥—Ä–æ–∫–∞:**

**–¢–µ–∫—É—â–µ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
- –ü–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤—Å–µ —Ñ–æ—Ç–æ —Å `person_id` —ç—Ç–æ–≥–æ –∏–≥—Ä–æ–∫–∞

**–ù–£–ñ–ù–û –ò–ó–ú–ï–ù–ò–¢–¨:**

**–ü—É–±–ª–∏—á–Ω—ã–µ –≥–∞–ª–µ—Ä–µ–∏ (–¥–ª—è –æ–±—ã—á–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π):**
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Ñ–æ—Ç–æ —Å:
  - `manually_verified = true`
  - –ò–õ–ò `confidence >= min_confidence_for_gallery` (–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ –ë–î)

**–ê–¥–º–∏–Ω–ø–∞–Ω–µ–ª—å:**
- –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –í–°–ï —Ñ–æ—Ç–æ –∏–≥—Ä–æ–∫–∞ —Å –ø—Ä–∏—Å–≤–æ–µ–Ω–Ω—ã–º `person_id`
- –ù–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç `confidence` –∏ `manually_verified`

**–ù–£–ñ–ù–û –î–û–ë–ê–í–ò–¢–¨:**
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ `min_confidence_for_gallery` –≤ –∞–¥–º–∏–Ω–ø–∞–Ω–µ–ª–∏
- –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é: 0.80 (80%)
- –î–∏–∞–ø–∞–∑–æ–Ω: 0.60 - 0.95 (60% - 95%)

---

## –¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ**
   - Drag & Drop —Å –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–º (dragCounter)
   - –ö–Ω–æ–ø–∫–∞ "–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ"
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Blob Storage –∏ –ë–î
   - ‚úÖ **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –º–µ—Ä—Ü–∞–Ω–∏–µ –ø—Ä–∏ drag & drop** (–≤–µ—Ä—Å–∏—è 0.5.9)

2. **–ü–∞–∫–µ—Ç–Ω–æ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ**
   - –î–µ—Ç–µ–∫—Ü–∏—è –ª–∏—Ü —á–µ—Ä–µ–∑ InsightFace
   - –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –ª–∏—Ü
   - –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫–∞—á–µ—Å—Ç–≤–∞ (blur, size, detection score)
   - ‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ `has_been_processed = true`** (–≤–µ—Ä—Å–∏—è 0.5.7)

3. **–°—Ç–∞—Ç—É—Å—ã —Ñ–æ—Ç–æ**
   - ‚úÖ **–ë–µ–∑ –±–µ–π–¥–∂–∞** –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ–æ—Ç–æ (`has_been_processed = false`)
   - ‚úÖ **NFD** (No Faces Detected) –¥–ª—è —Ñ–æ—Ç–æ –±–µ–∑ –ª–∏—Ü
   - ‚úÖ **XX/YY** –¥–ª—è —Ñ–æ—Ç–æ —Å –Ω–µ–æ–ø–æ–∑–Ω–∞–Ω–Ω—ã–º–∏ –ª–∏—Ü–∞–º–∏
   - XX% (—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å)
   - ‚úì (verified)

4. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–µ–Ω–¥–µ—Ä–∞**
   - ‚úÖ **–ú–µ–º–æ–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π** (React.memo)
   - ‚úÖ **–°—á–µ—Ç—á–∏–∫ dragCounter** –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –º–µ—Ä—Ü–∞–Ω–∏—è
   - ‚úÖ **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ drag & drop**

5. **–ö–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –ª–∏—Ü**
   - HDBSCAN –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è
   - –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
   - –ò—Å–∫–ª—é—á–µ–Ω–∏–µ —Ñ–æ—Ç–æ –∏–∑ –∫–ª–∞—Å—Ç–µ—Ä–∞

6. **–°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∏–≥—Ä–æ–∫–∞**
   - –ü–æ–ª–Ω—ã–π –¥–∏–∞–ª–æ–≥ AddPersonDialog
   - –í—Å–µ –ø–æ–ª—è (–∏–º—è, Telegram, —Å–æ—Ü—Å–µ—Ç–∏, —Ä–µ–π—Ç–∏–Ω–≥)

7. **–†—É—á–Ω–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è**
   - –î–∏–∞–ª–æ–≥ FaceTaggingDialog
   - –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤ –ª–∏—Ü–∞–º
   - –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Å `manually_verified = true`

8. **–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è**
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –≤ –∞–¥–º–∏–Ω–ø–∞–Ω–µ–ª–∏
   - –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –ë–î —á–µ—Ä–µ–∑ `load_quality_filters()`
   - –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–∏

9. **–ü–µ—Ä–µ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞ HNSWLIB**
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ—Å—Ç—Ä–æ–µ–Ω–∏–µ –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π
   - –ú–æ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ (–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ –ë–î)

10. **–ü–æ–ª–µ `context_weight` –≤ –ë–î**
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ –∞–¥–º–∏–Ω–ø–∞–Ω–µ–ª–∏
   - –ü–æ–ª–∑—É–Ω–æ–∫ –¥–ª—è —Ä–µ–≥—É–ª–∏—Ä–æ–≤–∫–∏
   - **–ù–û:** –õ–æ–≥–∏–∫–∞ —É—á–µ—Ç–∞ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –ù–ï —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ `recognize_face()`

---

## –ß—Ç–æ –Ω—É–∂–Ω–æ –¥–æ–¥–µ–ª–∞—Ç—å/–∏–∑–º–µ–Ω–∏—Ç—å

### –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ (–±–ª–æ–∫–∏—Ä—É—é—Ç —Ä–∞–±–æ—Ç—É):

#### 1. **–ü—Ä–∏—Å–≤–æ–µ–Ω–∏–µ —Ñ–æ—Ç–æ –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∏–≥—Ä–æ–∫–∞ –≤ –∫–ª–∞—Å—Ç–µ—Ä–∞—Ö**
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** (–≤–µ—Ä—Å–∏—è 0.5.1)

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–æ–¥ –µ—Å—Ç—å, –Ω–æ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç  
**–§–∞–π–ª—ã:** 
- `components/admin/unknown-faces-review-dialog.tsx`
- `components/admin/add-person-dialog.tsx`
- `app/admin/actions.ts`

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
- –ò—Å–ø—Ä–∞–≤–∏—Ç—å callback –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∏–≥—Ä–æ–∫–∞
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ `assignClusterToPersonAction()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
- –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É `manually_verified` –Ω–∞ –±—ç–∫–µ–Ω–¥–µ

---

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–≤–∞–∂–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª):

#### 2. **–î–æ–±–∞–≤–∏—Ç—å –≤—ã–±–æ—Ä —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞ –≤ –∫–ª–∞—Å—Ç–µ—Ä–∞—Ö**
**–°—Ç–∞—Ç—É—Å:** ‚è≥ **–í –ü–õ–ê–ù–ï**

**–§–∞–π–ª—ã:**
- `components/admin/unknown-faces-review-dialog.tsx`
- `app/admin/actions.ts`

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
- –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É "–í—ã–±—Ä–∞—Ç—å –∏–≥—Ä–æ–∫–∞"
- –°–µ–ª–µ–∫—Ç–æ—Ä –∏–≥—Ä–æ–∫–æ–≤ (Combobox) —Å –ø–æ–∏—Å–∫–æ–º
- –í—ã–∑–æ–≤ `assignClusterToPersonAction()` —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º `person_id`

---

#### 3. **–ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å—ã —Ñ–æ—Ç–æ (–±–µ–π–¥–∂–∏)**
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û** (–≤–µ—Ä—Å–∏—è 0.5.6-0.5.9)

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
- ‚úÖ –ó–∞–º–µ–Ω–∏–ª–∏ "NPD" –Ω–∞ "NFD"
- ‚úÖ –ó–∞–º–µ–Ω–∏–ª–∏ "DUP" –Ω–∞ "XX/YY"
- ‚úÖ –î–æ–±–∞–≤–∏–ª–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ "–±–µ–∑ –±–µ–π–¥–∂–∞" –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ–æ—Ç–æ
- ‚úÖ –î–æ–±–∞–≤–∏–ª–∏ –ø–æ–ª–µ `has_been_processed` –≤ –ë–î
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ `has_been_processed = true` –ø–æ—Å–ª–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –º–µ—Ä—Ü–∞–Ω–∏–µ –ø—Ä–∏ drag & drop

---

#### 4. **–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `has_been_processed` –≤ –ë–î**
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û** (–≤–µ—Ä—Å–∏—è 0.5.6)

**–§–∞–π–ª—ã:**
- SQL –º–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã `gallery_photos`
- `python/services/supabase_client.py`

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
1. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `has_been_processed BOOLEAN DEFAULT FALSE`
2. –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é: —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `has_been_processed = TRUE` –¥–ª—è –≤—Å–µ—Ö —Ñ–æ—Ç–æ —Å –∑–∞–ø–∏—Å—è–º–∏ –≤ `photo_faces`
3. –û–±–Ω–æ–≤–ª—è—Ç—å –Ω–∞ `true` –ø–æ—Å–ª–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –∏–ª–∏ —Ä—É—á–Ω–æ–π –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏

---

#### 5. **–î–æ–±–∞–≤–∏—Ç—å —á–µ–∫–±–æ–∫—Å "–ü—Ä–∏–º–µ–Ω—è—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞"**
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û** (–≤–µ—Ä—Å–∏—è 0.5.6)

**–§–∞–π–ª—ã:**
- `components/admin/gallery-images-manager.tsx`
- `python/routers/recognition.py`

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
- –ß–µ–∫–±–æ–∫—Å —Ä—è–¥–æ–º —Å –∫–Ω–æ–ø–∫–æ–π "–†–∞—Å–ø–æ–∑–Ω–∞—Ç—å —Ñ–æ—Ç–æ" (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –≤–∫–ª—é—á–µ–Ω)
- –ü–µ—Ä–µ–¥–∞–≤–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä `apply_quality_filters` –≤ API
- –ù–∞ –±—ç–∫–µ–Ω–¥–µ: –µ—Å–ª–∏ `false` - –Ω–µ –ø—Ä–∏–º–µ–Ω—è—Ç—å —Ñ–∏–ª—å—Ç—Ä—ã –∫–∞—á–µ—Å—Ç–≤–∞

---

#### 6. **–ù–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å —Ñ–æ—Ç–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏**
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û** (–≤–µ—Ä—Å–∏—è 0.5.6)

**–§–∞–π–ª—ã:**
- `components/admin/face-tagging-dialog.tsx`

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞–ª–∏—á–∏–µ –∑–∞–ø–∏—Å–µ–π –≤ `photo_faces` –ø–µ—Ä–µ–¥ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ–º
- –ï—Å–ª–∏ –µ—Å—Ç—å - –ø–æ–∫–∞–∑–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–µ–≥–∏
- –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É "–†–∞—Å–ø–æ–∑–Ω–∞—Ç—å –∑–∞–Ω–æ–≤–æ –±–µ–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫"
- –ü–æ–∫–∞–∑–∞—Ç—å –¥–µ—Ç–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–∏

---

#### 7. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —É—á–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–∏**
**–°—Ç–∞—Ç—É—Å:** ‚è≥ **–í –ü–õ–ê–ù–ï**

**–§–∞–π–ª—ã:**
- `python/services/face_recognition.py`

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
- –ü–µ—Ä–µ–¥–∞–≤–∞—Ç—å `photo_id` –∏ `gallery_id` –≤ `recognize_face()`
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞–ª–∏—á–∏–µ –∏–≥—Ä–æ–∫–∞ –Ω–∞ –¥—Ä—É–≥–∏—Ö –ª–∏—Ü–∞—Ö —ç—Ç–æ–≥–æ —Ñ–æ—Ç–æ
- –ü—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞–ª–∏—á–∏–µ –∏–≥—Ä–æ–∫–∞ –Ω–∞ –¥—Ä—É–≥–∏—Ö —Ñ–æ—Ç–æ —ç—Ç–æ–π –≥–∞–ª–µ—Ä–µ–∏
- –ü–æ–≤—ã—à–∞—Ç—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –Ω–∞ `context_weight` –ø—Ä–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏

**–°—Ç–∞—Ç—É—Å:** –ù–∞—Å—Ç—Ä–æ–π–∫–∞ `context_weight` –µ—Å—Ç—å –≤ –ë–î –∏ –∞–¥–º–∏–Ω–ø–∞–Ω–µ–ª–∏, –Ω–æ –ª–æ–≥–∏–∫–∞ –ù–ï —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞

**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –û—Ç–ª–æ–∂–µ–Ω–æ –Ω–∞ –ø–æ—Ç–æ–º - —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã —Ä–∞–±–æ—Ç–∞—é—Ç –ø—Ä–∏–µ–º–ª–µ–º–æ

---

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (—É–ª—É—á—à–µ–Ω–∏—è):

#### 8. **–î–æ–±–∞–≤–∏—Ç—å ENUM —Ç–∏–ø—ã –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ª—é–¥–µ–π**
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–†–ï–ê–õ–ò–ó–û–í–ê–ù–û** (–≤–µ—Ä—Å–∏—è 0.5.6)

**–§–∞–π–ª—ã:**
- SQL –º–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è ENUM —Ç–∏–ø–æ–≤
- SQL –º–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è —Ç–∞–±–ª–∏—Ü `people` –∏ `photo_faces`

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
1. –°–æ–∑–¥–∞—Ç—å ENUM —Ç–∏–ø—ã:
   \`\`\`sql
   CREATE TYPE person_category AS ENUM ('player', 'trainer');
   CREATE TYPE face_category AS ENUM ('player', 'trainer', 'spectator', 'unknown');
   \`\`\`

2. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `category` –≤ —Ç–∞–±–ª–∏—Ü—É `people`:
   \`\`\`sql
   ALTER TABLE people ADD COLUMN category person_category DEFAULT 'player';
   \`\`\`

3. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `face_category` –≤ —Ç–∞–±–ª–∏—Ü—É `photo_faces`:
   \`\`\`sql
   ALTER TABLE photo_faces ADD COLUMN face_category face_category DEFAULT 'unknown';
   \`\`\`

4. –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö:
   - –î–ª—è –≤—Å–µ—Ö —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–ø–∏—Å–µ–π –≤ `people`: —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `category = 'player'`
   - –î–ª—è –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π –≤ `photo_faces` —Å `person_id != NULL`: —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `face_category` –∏–∑ `people.category`
   - –î–ª—è –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π –≤ `photo_faces` —Å `person_id = NULL`: –æ—Å—Ç–∞–≤–∏—Ç—å `face_category = 'unknown'`

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ ENUM:**
- ‚úÖ –¢–∏–ø–∏–∑–∞—Ü–∏—è - –∑–∞—â–∏—Ç–∞ –æ—Ç –æ–ø–µ—á–∞—Ç–æ–∫
- ‚úÖ –õ—É—á—à–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —á–µ–º VARCHAR
- ‚úÖ –†–∞—Å—à–∏—Ä—è–µ–º–æ - –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- ‚úÖ PostgreSQL –Ω–∞—Ç–∏–≤–Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç ENUM

---

#### 9. **–î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É "–ó—Ä–∏—Ç–µ–ª–∏" –≤ –¥–∏–∞–ª–æ–≥–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤**
**–°—Ç–∞—Ç—É—Å:** ‚è≥ **–í –ü–õ–ê–ù–ï**

**–§–∞–π–ª—ã:**
- `components/admin/unknown-faces-review-dialog.tsx`
- `app/admin/actions.ts`

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
- –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É "–ó—Ä–∏—Ç–µ–ª–∏" —Ä—è–¥–æ–º —Å –¥—Ä—É–≥–∏–º–∏ –¥–µ–π—Å—Ç–≤–∏—è–º–∏
- –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏:
  - –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ: "–ü–æ–º–µ—Ç–∏—Ç—å N —Ñ–æ—Ç–æ –∫–∞–∫ –∑—Ä–∏—Ç–µ–ª–µ–π?"
  - –í—ã–∑–æ–≤ `markClusterAsSpectatorsAction()`
  - –î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ–æ—Ç–æ: `face_category = 'spectator'`, —É–¥–∞–ª–∏—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–∏
  - –ü–µ—Ä–µ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞

---

#### 10. **–î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `rejected` –¥–ª—è –æ—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã—Ö —Ñ–æ—Ç–æ**
**–°—Ç–∞—Ç—É—Å:** ‚è≥ **–í –ü–õ–ê–ù–ï**

**–§–∞–π–ª—ã:**
- SQL –º–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è —Ç–∞–±–ª–∏—Ü—ã `photo_faces`
- `components/admin/unknown-faces-review-dialog.tsx`
- `app/admin/actions.ts`

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
- –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `rejected BOOLEAN DEFAULT FALSE`
- –ö–Ω–æ–ø–∫–∞ "X" –Ω–∞ –∫–∞–∂–¥–æ–º —Ñ–æ—Ç–æ —Å—Ç–∞–≤–∏—Ç `rejected = true`
- –£–¥–∞–ª—è—Ç—å —ç–º–±–µ–¥–¥–∏–Ω–≥–∏ –æ—Ç–∫–ª–æ–Ω–µ–Ω–Ω—ã—Ö —Ñ–æ—Ç–æ
- –ò—Å–∫–ª—é—á–∞—Ç—å `rejected = true` –∏–∑ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏

---

#### 11. **–î–æ–±–∞–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫—É –ø–æ—Ä–æ–≥–∞ –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –≥–∞–ª–µ—Ä–µ–π**
**–°—Ç–∞—Ç—É—Å:** ‚è≥ **–í –ü–õ–ê–ù–ï**

**–§–∞–π–ª—ã:**
- `components/admin/face-training-manager.tsx`
- SQL: –¥–æ–±–∞–≤–∏—Ç—å `min_confidence_for_gallery` –≤ `face_recognition_config`
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –≥–∞–ª–µ—Ä–µ–π

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
- –ü–æ–ª–∑—É–Ω–æ–∫ –≤ –∞–¥–º–∏–Ω–ø–∞–Ω–µ–ª–∏ (60% - 95%, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 80%)
- –§–∏–ª—å—Ç—Ä–æ–≤–∞—Ç—å —Ñ–æ—Ç–æ –≤ **–ø—É–±–ª–∏—á–Ω—ã—Ö** –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –≥–∞–ª–µ—Ä–µ—è—Ö –ø–æ `manually_verified = true` –ò–õ–ò `confidence >= –ø–æ—Ä–æ–≥`
- –í **–∞–¥–º–∏–Ω–ø–∞–Ω–µ–ª–∏** –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å –í–°–ï —Ñ–æ—Ç–æ –∏–≥—Ä–æ–∫–∞

**–†–µ—à–µ–Ω–∏–µ:** –°–Ω–∏–∑—å –Ω–∞—Å—Ç—Ä–æ–π–∫—É "Min Confidence for Gallery" –∏–ª–∏ –≤—Ä—É—á–Ω—É—é –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä—É–π —Ñ–æ—Ç–æ.

---

#### 12. **–£–¥–∞–ª–µ–Ω–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤ –ø—Ä–∏ –ø–∞–∫–µ—Ç–Ω–æ–º —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–∏**
**–°—Ç–∞—Ç—É—Å:** ‚è≥ **–í –ü–õ–ê–ù–ï**

**–§–∞–π–ª—ã:**
- `python/routers/recognition.py`
- `python/services/supabase_client.py`

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
- –ü–µ—Ä–µ–¥ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ–º —É–¥–∞–ª—è—Ç—å –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã —É —Ñ–æ—Ç–æ –±–µ–∑ `manually_verified = true`
- –ü–µ—Ä–µ—Å—Ç—Ä–∞–∏–≤–∞—Ç—å –∏–Ω–¥–µ–∫—Å –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è

---

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç (–±—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è):

#### 13. **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –ª—é–¥–µ–π**
**–°—Ç–∞—Ç—É—Å:** –û—Å–Ω–æ–≤–∞ –≥–æ—Ç–æ–≤–∞ (ENUM —Ç–∏–ø—ã), –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å –Ω–æ–≤—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

**–ë—É–¥—É—â–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:**
- `referee` - –°—É–¥—å–∏
- `staff` - –ü–µ—Ä—Å–æ–Ω–∞–ª
- `photographer` - –§–æ—Ç–æ–≥—Ä–∞—Ñ—ã

**–ß—Ç–æ –Ω—É–∂–Ω–æ:**
1. –î–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –≤ ENUM:
   \`\`\`sql
   ALTER TYPE person_category ADD VALUE 'referee';
   ALTER TYPE face_category ADD VALUE 'referee';
   \`\`\`

2. –û–±–Ω–æ–≤–∏—Ç—å UI –¥–ª—è –≤—ã–±–æ—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —á–µ–ª–æ–≤–µ–∫–∞

3. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º –≤ —Å–ø–∏—Å–∫–∞—Ö –∏ –≥–∞–ª–µ—Ä–µ—è—Ö

---

#### 14. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ HDBSCAN –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è**
**–°—Ç–∞—Ç—É—Å:** –û—Ç–ª–æ–∂–µ–Ω–æ –Ω–∞ –ø–æ—Ç–æ–º

**–ò–¥–µ—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–ª–∞—Å—Ç–µ—Ä—ã –ø–æ—Ö–æ–∂–∏—Ö –ª–∏—Ü –æ–¥–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞ –¥–ª—è –ø–æ–≤—ã—à–µ–Ω–∏—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è

---

## –ü–æ—ç—Ç–∞–ø–Ω—ã–π –ø–ª–∞–Ω –∏–∑–º–µ–Ω–µ–Ω–∏–π

### –§–∞–∑–∞ 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (1-2 –¥–Ω—è)

**–¶–µ–ª—å:** –ò—Å–ø—Ä–∞–≤–∏—Ç—å –±–ª–æ–∫–∏—Ä—É—é—â–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

**–ó–∞–¥–∞—á–∏:**
1. ‚úÖ –ò—Å–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–∏—Å–≤–æ–µ–Ω–∏–µ —Ñ–æ—Ç–æ –ø–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –∏–≥—Ä–æ–∫–∞ –≤ –∫–ª–∞—Å—Ç–µ—Ä–∞—Ö
   - –û—Ç–ª–∞–¥–∏—Ç—å callback –≤ `AddPersonDialog`
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `assignClusterToPersonAction()`
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –ª–æ–≥–∏–∫—É `manually_verified` –Ω–∞ –±—ç–∫–µ–Ω–¥–µ

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –°–æ–∑–¥–∞–Ω–∏–µ –∏–≥—Ä–æ–∫–∞ –∏–∑ –∫–ª–∞—Å—Ç–µ—Ä–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

### –§–∞–∑–∞ 2: –û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª (3-5 –¥–Ω–µ–π)

**–¶–µ–ª—å:** –î–æ–±–∞–≤–∏—Ç—å –≤–∞–∂–Ω—ã–π –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

**–ó–∞–¥–∞—á–∏:**
1. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –≤—ã–±–æ—Ä —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞ –≤ –∫–ª–∞—Å—Ç–µ—Ä–∞—Ö
   - –ö–Ω–æ–ø–∫–∞ "–í—ã–±—Ä–∞—Ç—å –∏–≥—Ä–æ–∫–∞"
   - –°–µ–ª–µ–∫—Ç–æ—Ä —Å –ø–æ–∏—Å–∫–æ–º
   - Action –¥–ª—è –ø—Ä–∏—Å–≤–æ–µ–Ω–∏—è

2. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `has_been_processed` –≤ –ë–î
   - SQL –º–∏–≥—Ä–∞—Ü–∏—è
   - –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å TRUE –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ñ–æ—Ç–æ —Å –ª–∏—Ü–∞–º–∏)
   - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–∏

3. ‚úÖ –ò–∑–º–µ–Ω–∏—Ç—å —Å—Ç–∞—Ç—É—Å—ã —Ñ–æ—Ç–æ (–±–µ–π–¥–∂–∏)
   - NFD –≤–º–µ—Å—Ç–æ NPD
   - XX/YY –≤–º–µ—Å—Ç–æ DUP
   - –ë–µ–∑ –±–µ–π–¥–∂–∞ –¥–ª—è –Ω–æ–≤—ã—Ö —Ñ–æ—Ç–æ

4. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å —á–µ–∫–±–æ–∫—Å "–ü—Ä–∏–º–µ–Ω—è—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞"
   - UI —Ä—è–¥–æ–º —Å –∫–Ω–æ–ø–∫–æ–π
   - –ü–µ—Ä–µ–¥–∞—á–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –≤ API
   - –õ–æ–≥–∏–∫–∞ –Ω–∞ –±—ç–∫–µ–Ω–¥–µ

5. ‚úÖ –ù–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞—Ç—å —Ñ–æ—Ç–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ
   - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–µ–≥–æ–≤
   - –ö–Ω–æ–ø–∫–∞ "–†–∞—Å–ø–æ–∑–Ω–∞—Ç—å –∑–∞–Ω–æ–≤–æ –±–µ–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫"
   - –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–∏

6. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å ENUM —Ç–∏–ø—ã –¥–ª—è –∫–∞—Ç–µ–≥–æ—Ä–∏–π
   - SQL –º–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è ENUM
   - –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—è `category` –∏ `face_category`
   - –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö

7. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É "–ó—Ä–∏—Ç–µ–ª–∏" –≤ –¥–∏–∞–ª–æ–≥–µ –∫–ª–∞—Å—Ç–µ—Ä–æ–≤
   - –ö–Ω–æ–ø–∫–∞ –≤ UI
   - Action –¥–ª—è –ø–æ–º–µ—Ç–∫–∏ –∑—Ä–∏—Ç–µ–ª–µ–π
   - –õ–æ–≥–∏–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è `face_category`

8. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª–µ `rejected` –∏ –ª–æ–≥–∏–∫—É –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è
   - SQL –º–∏–≥—Ä–∞—Ü–∏—è
   - –ö–Ω–æ–ø–∫–∞ "X" –Ω–∞ –∫–∞–∂–¥–æ–º —Ñ–æ—Ç–æ
   - –ò—Å–∫–ª—é—á–µ–Ω–∏–µ –∏–∑ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏

9. ‚úÖ –£–¥–∞–ª–∏—Ç—å –∫–Ω–æ–ø–∫—É "–ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å"

10. ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –µ–¥–∏–Ω–∏—á–Ω—ã–µ —Ñ–æ—Ç–æ –≤ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª —Ä–∞–±–æ—Ç—ã —Å –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–º–∏ –ª–∏—Ü–∞–º–∏ –∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ –ª—é–¥–µ–π

---

### –§–∞–∑–∞ 3: –£–ª—É—á—à–µ–Ω–∏—è UI –∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ (2-3 –¥–Ω—è)

**–¶–µ–ª—å:** –£–ª—É—á—à–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç

**–ó–∞–¥–∞—á–∏:**
1. ‚úÖ –î–æ–±–∞–≤–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫—É –ø–æ—Ä–æ–≥–∞ –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã—Ö –≥–∞–ª–µ—Ä–µ–π
   - –ü–æ–ª–∑—É–Ω–æ–∫ –≤ –∞–¥–º–∏–Ω–ø–∞–Ω–µ–ª–∏
   - –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –≤ –ø—É–±–ª–∏—á–Ω—ã—Ö –≥–∞–ª–µ—Ä–µ—è—Ö
   - –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –≤—Å–µ –≤ –∞–¥–º–∏–Ω–ø–∞–Ω–µ–ª–∏

2. ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤ –ø—Ä–∏ –ø–∞–∫–µ—Ç–Ω–æ–º —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–∏
   - –£–¥–∞–ª–µ–Ω–∏–µ —É –Ω–µ–≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–æ—Ç–æ
   - –ü–µ—Ä–µ—Å—Ç—Ä–æ–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞

3. ‚úÖ –£–ª—É—á—à–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤
   - –ü–æ–¥—Å–∫–∞–∑–∫–∏ (tooltips)
   - –¶–≤–µ—Ç–æ–≤–æ–µ –∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –£–¥–æ–±–Ω—ã–π –∏ –ø–æ–Ω—è—Ç–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

---

### –§–∞–∑–∞ 4: –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è (–ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)

**–ó–∞–¥–∞—á–∏:**
1. ‚è≥ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —É—á–µ—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ –≤ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–∏ (–æ—Ç–ª–æ–∂–µ–Ω–æ)
2. ‚è≥ –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –ª—é–¥–µ–π (–ò–≥—Ä–æ–∫–∏, –¢—Ä–µ–Ω–µ—Ä—ã, –ó—Ä–∏—Ç–µ–ª–∏)
3. ‚è≥ –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–π blur_score (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ª–∏—Ü–∞)
4. ‚è≥ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ HDBSCAN –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
5. ‚è≥ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
6. ‚è≥ –≠–∫—Å–ø–æ—Ä—Ç/–∏–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö

---

## –û–ø–∏—Å–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ (Quality Filters)

**–ì–¥–µ:** –ê–¥–º–∏–Ω–ø–∞–Ω–µ–ª—å ‚Üí Face Training Manager ‚Üí Quality Filters

#### 1. **Min Face Size** (–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ª–∏—Ü–∞)
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –ª–∏—Ü–∞ –≤ –ø–∏–∫—Å–µ–ª—è—Ö –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
- **–î–∏–∞–ø–∞–∑–æ–Ω:** 20 - 100 px
- **–®–∞–≥:** 5 px
- **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é:** 40 px
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
  - 20-30 px: –û—á–µ–Ω—å –º–∞–ª–µ–Ω—å–∫–∏–µ –ª–∏—Ü–∞ (–Ω–∏–∑–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ)
  - 40-50 px: –ù–æ—Ä–º–∞–ª—å–Ω—ã–µ –ª–∏—Ü–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
  - 60-100 px: –¢–æ–ª—å–∫–æ –∫—Ä—É–ø–Ω—ã–µ –ª–∏—Ü–∞ (–≤—ã—Å–æ–∫–æ–µ –∫–∞—á–µ—Å—Ç–≤–æ)

#### 2. **Min Blur Score** (–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ä–µ–∑–∫–æ—Å—Ç—å)
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Ä–µ–∑–∫–æ—Å—Ç—å –ª–∏—Ü–∞ –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
- **–î–∏–∞–ø–∞–∑–æ–Ω:** 30 - 150
- **–®–∞–≥:** 10
- **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é:** 60
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
  - 30-50: –†–∞–∑–º—ã—Ç—ã–µ –ª–∏—Ü–∞ –¥–æ–ø—É—Å–∫–∞—é—Ç—Å—è
  - 60-80: –ù–æ—Ä–º–∞–ª—å–Ω–∞—è —Ä–µ–∑–∫–æ—Å—Ç—å (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
  - 90-150: –¢–æ–ª—å–∫–æ —á–µ—Ç–∫–∏–µ –ª–∏—Ü–∞

**–í–∞–∂–Ω–æ:** Blur score –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–∑–º–µ—Ä–∞ –ª–∏—Ü–∞. –ú–∞–ª–µ–Ω—å–∫–∏–µ –ª–∏—Ü–∞ –∏–º–µ—é—Ç –Ω–∏–∑–∫–∏–π blur score –¥–∞–∂–µ –ø—Ä–∏ —Ö–æ—Ä–æ—à–µ–π —Ä–µ–∑–∫–æ—Å—Ç–∏. –¢–∏–ø–∏—á–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è –Ω–æ—Ä–º–∞–ª—å–Ω—ã—Ö —Ñ–æ—Ç–æ: 20-100.

#### 3. **Min Detection Score** (–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –¥–µ—Ç–µ–∫—Ü–∏–∏)
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å InsightFace –≤ —Ç–æ–º, —á—Ç–æ —ç—Ç–æ –ª–∏—Ü–æ
- **–î–∏–∞–ø–∞–∑–æ–Ω:** 0.5 - 0.95
- **–®–∞–≥:** 0.05
- **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é:** 0.7
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
  - 0.5-0.6: –ù–∏–∑–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å (–º–Ω–æ–≥–æ –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π)
  - 0.7-0.8: –ù–æ—Ä–º–∞–ª—å–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
  - 0.85-0.95: –í—ã—Å–æ–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å (—Ç–æ–ª—å–∫–æ –æ—á–µ–≤–∏–¥–Ω—ã–µ –ª–∏—Ü–∞)

---

### –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è (Recognition Settings)

#### 4. **Context Weight** (–í–µ—Å –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞)
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ù–∞—Å–∫–æ–ª—å–∫–æ –ø–æ–≤—ã—à–∞—Ç—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –ø—Ä–∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- **–î–∏–∞–ø–∞–∑–æ–Ω:** 0.0 - 0.3
- **–®–∞–≥:** 0.05
- **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é:** 0.1
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
  - 0.0: –ö–æ–Ω—Ç–µ–∫—Å—Ç –Ω–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è
  - 0.1: –ù–µ–±–æ–ª—å—à–æ–µ –ø–æ–≤—ã—à–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
  - 0.2-0.3: –°–∏–ª—å–Ω–æ–µ –ø–æ–≤—ã—à–µ–Ω–∏–µ (–º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –æ—à–∏–±–∫–∞–º)

**–ü—Ä–∏–º–µ—Ä:** –ï—Å–ª–∏ –±–∞–∑–æ–≤–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å 0.65, –∞ context_weight = 0.1, —Ç–æ –∏—Ç–æ–≥–æ–≤–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å = 0.75

#### 5. **Min Confidence for Gallery** (–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –¥–ª—è –≥–∞–ª–µ—Ä–µ–∏)
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –¥–ª—è –ø–æ–∫–∞–∑–∞ —Ñ–æ—Ç–æ –≤ **–ø—É–±–ª–∏—á–Ω–æ–π** –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–π –≥–∞–ª–µ—Ä–µ–µ –∏–≥—Ä–æ–∫–∞
- **–î–∏–∞–ø–∞–∑–æ–Ω:** 0.60 - 0.95
- **–®–∞–≥:** 0.05
- **–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é:** 0.80
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**
  - 0.60-0.70: –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å –±–æ–ª—å—à–µ —Ñ–æ—Ç–æ (–º–æ–≥—É—Ç –±—ã—Ç—å –æ—à–∏–±–∫–∏)
  - 0.80-0.85: –ë–∞–ª–∞–Ω—Å (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
  - 0.90-0.95: –¢–æ–ª—å–∫–æ –æ—á–µ–Ω—å —É–≤–µ—Ä–µ–Ω–Ω—ã–µ (–º–∞–ª–æ —Ñ–æ—Ç–æ)

**–í–∞–∂–Ω–æ:** 
- –§–æ—Ç–æ —Å `manually_verified = true` –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –≤—Å–µ–≥–¥–∞, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
- –í **–∞–¥–º–∏–Ω–ø–∞–Ω–µ–ª–∏** –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –í–°–ï —Ñ–æ—Ç–æ –∏–≥—Ä–æ–∫–∞, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —ç—Ç–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

---

### –ü–æ—Ä–æ–≥–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è (Recognition Thresholds)

**–ì–¥–µ:** –ñ–µ—Å—Ç–∫–æ –∑–∞–¥–∞–Ω—ã –≤ –∫–æ–¥–µ (–º–æ–∂–Ω–æ –≤—ã–Ω–µ—Å—Ç–∏ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)

#### 6. **Verified Threshold** (–ü–æ—Ä–æ–≥ –¥–ª—è –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ª–∏—Ü)
- **–¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:** 0.6
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ö–æ–∂–µ—Å—Ç—å –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Å—Ä–µ–¥–∏ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ª–∏—Ü

#### 7. **Unverified Threshold** (–ü–æ—Ä–æ–≥ –¥–ª—è –Ω–µ–≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ª–∏—Ü)
- **–¢–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ:** 0.75
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è —Å—Ö–æ–∂–µ—Å—Ç—å –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Å—Ä–µ–¥–∏ –Ω–µ–≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ª–∏—Ü

**–õ–æ–≥–∏–∫–∞:** –î–ª—è –Ω–µ–≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ª–∏—Ü –ø–æ—Ä–æ–≥ –≤—ã—à–µ, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –ª–æ–∂–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π.

---

## –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –ë–∞–∑–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞–±–æ—Ç—ã

#### 1. –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ
1. –û—Ç–∫—Ä–æ–π –≥–∞–ª–µ—Ä–µ—é —á–µ—Ä–µ–∑ –∫–Ω–æ–ø–∫—É "Images" üì∑
2. –ó–∞–≥—Ä—É–∑–∏ —Ñ–æ—Ç–æ:
   - –ù–∞–∂–º–∏ "–ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–æ—Ç–æ" –∏ –≤—ã–±–µ—Ä–∏ —Ñ–∞–π–ª—ã
   - –ò–ª–∏ –ø–µ—Ä–µ—Ç–∞—â–∏ —Ñ–∞–π–ª—ã –≤ –æ–∫–Ω–æ (drag & drop)
3. –§–æ—Ç–æ –ø–æ—è–≤—è—Ç—Å—è –≤ –≥–∞–ª–µ—Ä–µ–µ –±–µ–∑ –±–µ–π–¥–∂–∞ (–Ω–æ–≤—ã–µ)

#### 2. –ü–∞–∫–µ—Ç–Ω–æ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ
1. –ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É "–†–∞—Å–ø–æ–∑–Ω–∞—Ç—å —Ñ–æ—Ç–æ" üîç
2. –£–±–µ–¥–∏—Å—å, —á—Ç–æ —á–µ–∫–±–æ–∫—Å "–ü—Ä–∏–º–µ–Ω—è—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞" –≤–∫–ª—é—á–µ–Ω (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
3. –î–æ–∂–¥–∏—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
4. –ü—Ä–æ–≤–µ—Ä—å —Å—Ç–∞—Ç—É—Å—ã —Ñ–æ—Ç–æ:
   - ‚úì (–∑–µ–ª–µ–Ω—ã–π) - –≤—Å–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ
   - XX% (—Å–∏–Ω–∏–π) - —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–æ, –Ω–æ –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ
   - XX/YY (–æ—Ä–∞–Ω–∂–µ–≤—ã–π) - –µ—Å—Ç—å –Ω–µ–æ–ø–æ–∑–Ω–∞–Ω–Ω—ã–µ –ª–∏—Ü–∞
   - NFD (—Å–µ—Ä—ã–π) - –ª–∏—Ü–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã

#### 3. –†–∞–±–æ—Ç–∞ —Å –Ω–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–º–∏ –ª–∏—Ü–∞–º–∏
1. –ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ –ª–∏—Ü–∞" üë§+
2. –°–∏—Å—Ç–µ–º–∞ –ø–æ–∫–∞–∂–µ—Ç –∫–ª–∞—Å—Ç–µ—Ä—ã –ø–æ—Ö–æ–∂–∏—Ö –ª–∏—Ü
3. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞:
   - –ü—Ä–æ–≤–µ—Ä—å, –≤—Å–µ –ª–∏ —Ñ–æ—Ç–æ –æ–¥–Ω–æ–≥–æ —á–µ–ª–æ–≤–µ–∫–∞
   - –ï—Å–ª–∏ –µ—Å—Ç—å –æ—à–∏–±–∫–∏ - –Ω–∞–∂–º–∏ "X" –Ω–∞ –æ—à–∏–±–æ—á–Ω—ã—Ö —Ñ–æ—Ç–æ
   - –í—ã–±–µ—Ä–∏ –¥–µ–π—Å—Ç–≤–∏–µ:
     - **"–°–æ–∑–¥–∞—Ç—å –∏–≥—Ä–æ–∫–∞"** - –µ—Å–ª–∏ —ç—Ç–æ –Ω–æ–≤—ã–π –∏–≥—Ä–æ–∫
     - **"–í—ã–±—Ä–∞—Ç—å –∏–≥—Ä–æ–∫–∞"** - –µ—Å–ª–∏ –∏–≥—Ä–æ–∫ —É–∂–µ –µ—Å—Ç—å –≤ —Å–∏—Å—Ç–µ–º–µ
     - **"–ó—Ä–∏—Ç–µ–ª–∏"** - –µ—Å–ª–∏ —ç—Ç–æ –Ω–µ –∏–≥—Ä–æ–∫ (–∑—Ä–∏—Ç–µ–ª—å, —Å—É–¥—å—è)
     - **"–°–ª–µ–¥—É—é—â–∏–π"** - –ø–µ—Ä–µ–π—Ç–∏ –∫ —Å–ª–µ–¥—É—é—â–µ–º—É –∫–ª–∞—Å—Ç–µ—Ä—É

#### 4. –†—É—á–Ω–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è
1. –ö–ª–∏–∫–Ω–∏ –Ω–∞ —Ñ–æ—Ç–æ —Å –±–µ–π–¥–∂–µ–º XX% –∏–ª–∏ XX/YY
2. –û—Ç–∫—Ä–æ–µ—Ç—Å—è –¥–∏–∞–ª–æ–≥ —Å –ª–∏—Ü–∞–º–∏ –Ω–∞ —Ñ–æ—Ç–æ
3. –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ª–∏—Ü–∞ –≤—ã–±–µ—Ä–∏ –∏–≥—Ä–æ–∫–∞ –∏–∑ —Å–ø–∏—Å–∫–∞
4. –ù–∞–∂–º–∏ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å" (–∞–∫—Ç–∏–≤–Ω–∞ —Ç–æ–ª—å–∫–æ –∫–æ–≥–¥–∞ –≤—Å–µ –ª–∏—Ü–∞ –Ω–∞–∑–Ω–∞—á–µ–Ω—ã)
5. –§–æ—Ç–æ –ø–æ–ª—É—á–∏—Ç —Å—Ç–∞—Ç—É—Å ‚úì (verified)

#### 5. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
1. –û—Ç–∫—Ä–æ–π –∞–¥–º–∏–Ω–ø–∞–Ω–µ–ª—å ‚Üí Face Training Manager
2. –ù–∞—Å—Ç—Ä–æ–π —Ñ–∏–ª—å—Ç—Ä—ã –∫–∞—á–µ—Å—Ç–≤–∞:
   - **Min Face Size:** 40 px (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
   - **Min Blur Score:** 60-80 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
   - **Min Detection Score:** 0.7 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
3. –ù–∞—Å—Ç—Ä–æ–π —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ:
   - **Context Weight:** 0.1 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
   - **Min Confidence for Gallery:** 0.80 (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
4. –ù–∞–∂–º–∏ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏"

---

### –ß–∞—Å—Ç—ã–µ –≤–æ–ø—Ä–æ—Å—ã

#### Q: –ü–æ—á–µ–º—É –Ω–µ–∫–æ—Ç–æ—Ä—ã–µ –ª–∏—Ü–∞ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞—é—Ç—Å—è?
**A:** –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
1. –õ–∏—Ü–æ —Å–ª–∏—à–∫–æ–º –º–∞–ª–µ–Ω—å–∫–æ–µ (< Min Face Size)
2. –õ–∏—Ü–æ —Ä–∞–∑–º—ã—Ç–æ–µ (< Min Blur Score)
3. –ù–∏–∑–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –¥–µ—Ç–µ–∫—Ü–∏–∏ (< Min Detection Score)
4. –ò–≥—Ä–æ–∫–∞ –Ω–µ—Ç –≤ –±–∞–∑–µ (–Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —á–µ—Ä–µ–∑ "–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–µ –ª–∏—Ü–∞")

**–†–µ—à–µ–Ω–∏–µ:** –°–Ω–∏–∑—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞ –∏–ª–∏ –æ—Ç–∫–ª—é—á–∏ —á–µ–∫–±–æ–∫—Å "–ü—Ä–∏–º–µ–Ω—è—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞"

#### Q: –ö–∞–∫ —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å —Ñ–æ—Ç–æ –±–µ–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∫–∞—á–µ—Å—Ç–≤–∞?
**A:** 
1. –ü—Ä–∏ –ø–∞–∫–µ—Ç–Ω–æ–º —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–∏: –æ—Ç–∫–ª—é—á–∏ —á–µ–∫–±–æ–∫—Å "–ü—Ä–∏–º–µ–Ω—è—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞"
2. –ü—Ä–∏ —Ä—É—á–Ω–æ–π –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏: –Ω–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É "–†–∞—Å–ø–æ–∑–Ω–∞—Ç—å –∑–∞–Ω–æ–≤–æ –±–µ–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫"

#### Q: –ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ AI –æ—à–∏–±—Å—è –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ?
**A:** –ù–∞–∂–º–∏ "X" –Ω–∞ –æ—à–∏–±–æ—á–Ω—ã—Ö —Ñ–æ—Ç–æ, —á—Ç–æ–±—ã –∏—Å–∫–ª—é—á–∏—Ç—å –∏—Ö –∏–∑ –∫–ª–∞—Å—Ç–µ—Ä–∞. –û–Ω–∏ –Ω–µ –±—É–¥—É—Ç –ø—Ä–∏—Å–≤–æ–µ–Ω—ã –∏–≥—Ä–æ–∫—É.

#### Q: –ö–∞–∫ –æ—Ç–ª–∏—á–∏—Ç—å –∑—Ä–∏—Ç–µ–ª–µ–π –æ—Ç –∏–≥—Ä–æ–∫–æ–≤?
**A:** –ü—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å –∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏ –Ω–∞–∂–º–∏ "–ó—Ä–∏—Ç–µ–ª–∏". –û–Ω–∏ –±—É–¥—É—Ç –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ `is_spectator = true` –∏ –Ω–µ –±—É–¥—É—Ç —É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å –≤ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–∏ –∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–∏.

#### Q: –ü–æ—á–µ–º—É –≤ –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–æ–π –≥–∞–ª–µ—Ä–µ–µ –∏–≥—Ä–æ–∫–∞ –Ω–µ –≤—Å–µ —Ñ–æ—Ç–æ?
**A:** 
- –í **–ø—É–±–ª–∏—á–Ω–æ–π –≥–∞–ª–µ—Ä–µ–µ** –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ —Ñ–æ—Ç–æ —Å:
  - –†—É—á–Ω–æ–π –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–µ–π (‚úì)
  - –ò–ª–∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å—é >= Min Confidence for Gallery (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 80%)
- –í **–∞–¥–º–∏–Ω–ø–∞–Ω–µ–ª–∏** –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –í–°–ï —Ñ–æ—Ç–æ –∏–≥—Ä–æ–∫–∞

**–†–µ—à–µ–Ω–∏–µ:** –°–Ω–∏–∑—å –Ω–∞—Å—Ç—Ä–æ–π–∫—É "Min Confidence for Gallery" –∏–ª–∏ –≤—Ä—É—á–Ω—É—é –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä—É–π —Ñ–æ—Ç–æ.

#### Q: –ö–∞–∫ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –¥–µ—Ç–∞–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–∏?
**A:** –í —Ä—É—á–Ω–æ–π –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –Ω–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É "–†–∞—Å–ø–æ–∑–Ω–∞—Ç—å –∑–∞–Ω–æ–≤–æ –±–µ–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫". –ü–æ—Å–ª–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –æ–∫–Ω–æ —Å –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –∫–∞–∂–¥–æ–º –ª–∏—Ü–µ: —Ä–∞–∑–º–µ—Ä, blur score, detection score, –∫–∞—á–µ—Å—Ç–≤–æ —ç–º–±–µ–¥–¥–∏–Ω–≥–∞, —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –¥–æ –∏–∑–≤–µ—Å—Ç–Ω—ã—Ö –ª–∏—Ü –∏ —Ç–æ–ø-3 –ø–æ—Ö–æ–∂–∏—Ö.

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –æ–ø–∏—Å—ã–≤–∞–µ—Ç –ø–æ–ª–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –ª–∏—Ü –≤ —Å–∏—Å—Ç–µ–º–µ Galeries, –≤–∫–ª—é—á–∞—è —Ç–µ–∫—É—â—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –∏ –ø–ª–∞–Ω –∏–∑–º–µ–Ω–µ–Ω–∏–π. 

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
1. –°–æ–≥–ª–∞—Å–æ–≤–∞—Ç—å –ø–ª–∞–Ω –∏–∑–º–µ–Ω–µ–Ω–∏–π
2. –ü—Ä–∏—Å—Ç—É–ø–∏—Ç—å –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –§–∞–∑—ã 1 (–∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)
3. –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Ñ–∞–∑—ã
4. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –∫–∞–∂–¥—É—é —Ñ–∞–∑—É –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ—Ö–æ–¥–æ–º –∫ —Å–ª–µ–¥—É—é—â–µ–π

**–ö–æ–Ω—Ç–∞–∫—Ç—ã –¥–ª—è –≤–æ–ø—Ä–æ—Å–æ–≤:**
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: —ç—Ç–æ—Ç —Ñ–∞–π–ª
- –ö–æ–¥: —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –ø—Ä–æ–µ–∫—Ç–∞
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞: —á–µ—Ä–µ–∑ issues –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

---

**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 3.4.0  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 31 –æ–∫—Ç—è–±—Ä—è 2025

## –ö–ª—é—á–µ–≤—ã–µ –ø–æ–Ω—è—Ç–∏—è –ø—Ä–æ–µ–∫—Ç–∞

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

**–§—Ä–æ–Ω—Ç–µ–Ω–¥ (Next.js 16 + React 19):**
- `gallery-images-manager.tsx` - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥–∞–ª–µ—Ä–µ–µ–π, –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–µ–π–¥–∂–µ–π
- `auto-recognition-dialog.tsx` - –ø–∞–∫–µ—Ç–Ω–æ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ
- `unknown-faces-review-dialog.tsx` - —Ä–∞–±–æ—Ç–∞ —Å –∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏
- `face-tagging-dialog.tsx` - —Ä—É—á–Ω–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è

**–ë—ç–∫–µ–Ω–¥ (FastAPI + Python):**
- `main.py` - –≥–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª API (–≤–µ—Ä—Å–∏—è 3.2.7)
- `services/face_recognition.py` - —Å–µ—Ä–≤–∏—Å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è (InsightFace)
- `services/supabase_client.py` - —Ä–∞–±–æ—Ç–∞ —Å –ë–î
- `services/training_service.py` - –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è (HDBSCAN)

**–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (Supabase PostgreSQL):**
- `gallery_photos` - —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ (—Å –ø–æ–ª–µ–º `has_been_processed`)
- `photo_faces` - –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ –ª–∏—Ü–∞
- `photo_face_descriptors` - –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã (512-–º–µ—Ä–Ω—ã–µ –≤–µ–∫—Ç–æ—Ä—ã)
- `people` - –ª—é–¥–∏ (–∏–≥—Ä–æ–∫–∏, —Ç—Ä–µ–Ω–µ—Ä—ã)
- `face_recognition_config` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è

### –ü—Ä–æ—Ü–µ—Å—Å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è

1. **–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ** ‚Üí Vercel Blob Storage + –ë–î (`has_been_processed = false`)
2. **–î–µ—Ç–µ–∫—Ü–∏—è –ª–∏—Ü** ‚Üí InsightFace (`/detect-faces`)
3. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–∞—á–µ—Å—Ç–≤–∞** ‚Üí blur_score, size, detection_score
4. **–†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ** ‚Üí –ø–æ–∏—Å–∫ –ø–æ—Ö–æ–∂–∏—Ö –ª–∏—Ü (`/recognize-face`)
5. **–£—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—Ç–∞—Ç—É—Å–∞** ‚Üí `has_been_processed = true`
6. **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –±–µ–π–¥–∂–∞** ‚Üí NFD, XX/YY, XX%, ‚úì

### –°—Ç–∞—Ç—É—Å—ã —Ñ–æ—Ç–æ (–±–µ–π–¥–∂–∏)

- **–ë–µ–∑ –±–µ–π–¥–∂–∞** - –Ω–æ–≤–æ–µ —Ñ–æ—Ç–æ (`has_been_processed = false`)
- **NFD** (—Å–µ—Ä—ã–π) - –ª–∏—Ü–∞ –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω—ã
- **XX/YY** (–æ—Ä–∞–Ω–∂–µ–≤—ã–π) - –Ω–µ–æ–ø–æ–∑–Ω–∞–Ω–Ω—ã–µ –ª–∏—Ü–∞
- **XX%** (—Å–∏–Ω–∏–π) - —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
- **‚úì** (–∑–µ–ª–µ–Ω—ã–π) - –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–æ

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è UI

- **dragCounter** - —Å—á–µ—Ç—á–∏–∫ –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –º–µ—Ä—Ü–∞–Ω–∏—è –ø—Ä–∏ drag & drop
- **React.memo** - –º–µ–º–æ–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- **GalleryImageCard** - –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è

---

**–í–µ—Ä—Å–∏—è –¥–æ–∫—É–º–µ–Ω—Ç–∞:** 3.4.0  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 31 –æ–∫—Ç—è–±—Ä—è 2025
