# –ê—É–¥–∏—Ç —Å–∏—Å—Ç–µ–º—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–î–∞—Ç–∞:** 31.10.2025  
**–°—Ç–∞—Ç—É—Å:** –í —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ  
**–í–µ—Ä—Å–∏—è:** 5.0

---

## üìä –ê–∫—Ç—É–∞–ª—å–Ω–∞—è —Å—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ `photo_faces`
–•—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ª–∏—Ü–∞—Ö, –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö –Ω–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è—Ö.

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | FK |
|------|-----|----------|-----|
| `id` | uuid | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á | - |
| `photo_id` | uuid | –°—Å—ã–ª–∫–∞ –Ω–∞ —Ñ–æ—Ç–æ | ‚Üí `gallery_images.id` |
| `person_id` | uuid | –°—Å—ã–ª–∫–∞ –Ω–∞ –∏–≥—Ä–æ–∫–∞ | ‚Üí `people.id` |
| `verified` | boolean | –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ –≤—Ä—É—á–Ω—É—é | - |
| `recognition_confidence` | double precision | –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è (0-1) | - |
| `confidence` | double precision | –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å –¥–µ—Ç–µ–∫—Ü–∏–∏ (0-1) | - |
| `blur_score` | double precision | –û—Ü–µ–Ω–∫–∞ —Ä–∞–∑–º—ã—Ç–∏—è (0-1) | - |
| `bounding_box` | jsonb | –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã –ª–∏—Ü–∞ | - |

### –¢–∞–±–ª–∏—Ü–∞ `face_descriptors`
–•—Ä–∞–Ω–∏—Ç –≤–µ–∫—Ç–æ—Ä–Ω—ã–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è (—ç–º–±–µ–¥–¥–∏–Ω–≥–∏) –ª–∏—Ü –¥–ª—è —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è.

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | FK |
|------|-----|----------|-----|
| `id` | uuid | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á | - |
| `source_image_id` | uuid | –°—Å—ã–ª–∫–∞ –Ω–∞ –ª–∏—Ü–æ | ‚Üí `photo_faces.id` |
| `person_id` | uuid | –°—Å—ã–ª–∫–∞ –Ω–∞ –∏–≥—Ä–æ–∫–∞ | ‚Üí `people.id` |
| `descriptor` | jsonb | –í–µ–∫—Ç–æ—Ä–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –ª–∏—Ü–∞ | - |

### –¢–∞–±–ª–∏—Ü–∞ `gallery_images`
–•—Ä–∞–Ω–∏—Ç —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –≤ –≥–∞–ª–µ—Ä–µ—è—Ö.

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | FK |
|------|-----|----------|-----|
| `id` | uuid | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á | - |
| `original_filename` | text | –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –∏–º—è —Ñ–∞–π–ª–∞ | - |
| `image_url` | text | URL –≤ Vercel Blob | - |
| `gallery_id` | uuid | –°—Å—ã–ª–∫–∞ –Ω–∞ –≥–∞–ª–µ—Ä–µ—é | ‚Üí `galleries.id` |

**‚ö†Ô∏è –í–ê–ñ–ù–û:** –ü–æ–ª–µ `face_count` –ù–ï –°–£–©–ï–°–¢–í–£–ï–¢ –≤ —Ç–∞–±–ª–∏—Ü–µ (–±—ã–ª–æ —É–¥–∞–ª–µ–Ω–æ –∏–∑ –ø—Ä–æ–≤–µ—Ä–æ–∫).

### –¢–∞–±–ª–∏—Ü–∞ `people`
–•—Ä–∞–Ω–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ–± –∏–≥—Ä–æ–∫–∞—Ö.

| –ü–æ–ª–µ | –¢–∏–ø | –û–ø–∏—Å–∞–Ω–∏–µ | FK |
|------|-----|----------|-----|
| `id` | uuid | –ü–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á | - |
| `real_name` | text | –ò–º—è –∏–≥—Ä–æ–∫–∞ | - |

---

## üìã –§–∏–Ω–∞–ª—å–Ω—ã–π —Å–ø–∏—Å–æ–∫ –ø—Ä–æ–≤–µ—Ä–æ–∫ (23 –ø—Ä–æ–≤–µ—Ä–∫–∏)

### –ö–ê–¢–ï–ì–û–†–ò–Ø 1: Photo Faces (–ª–∏—Ü–∞ –Ω–∞ —Ñ–æ—Ç–æ) - 10 –ø—Ä–æ–≤–µ—Ä–æ–∫

#### 1.1. –ü—Ä–æ–±–ª–µ–º—ã —Å –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–µ–π

**1.1.1 Verified faces –±–µ–∑ person_id**
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –õ–∏—Ü–∞ —Å `verified=true`, –Ω–æ `person_id=null`
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** `verified=false`, `recognition_confidence=null`
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

**1.1.2 Verified faces —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º confidence**
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –õ–∏—Ü–∞ —Å `verified=true`, –Ω–æ `recognition_confidence != 1.0`
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** `recognition_confidence=1.0`
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

#### 1.2. –ü—Ä–æ–±–ª–µ–º—ã —Å person_id –∏ confidence

**1.2.1 Person_id —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –Ω–æ confidence = NULL/0**
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –õ–∏—Ü–∞ —Å `person_id NOT NULL`, –Ω–æ `recognition_confidence IS NULL` –∏–ª–∏ `= 0`
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –ü–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å —á–µ—Ä–µ–∑ FastAPI, –µ—Å–ª–∏ < –ø–æ—Ä–æ–≥–∞ - —É–¥–∞–ª–∏—Ç—å —Å–≤—è–∑—å, –µ—Å–ª–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–ª—Å—è –¥—Ä—É–≥–æ–π - –∑–∞–º–µ–Ω–∏—Ç—å
- **–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û (—É—Å—Ç—Ä–∞–Ω—è–µ—Ç confidence = NULL/0, –Ω–æ –Ω–µ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç —á–µ—Ä–µ–∑ FastAPI)

**1.2.2 Recognition_confidence —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –Ω–æ person_id = NULL**
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –õ–∏—Ü–∞ —Å `recognition_confidence NOT NULL`, –Ω–æ `person_id=null`
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** `recognition_confidence=NULL`
- **–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

#### 1.3. –ü—Ä–æ–±–ª–µ–º—ã —Å –≤–Ω–µ—à–Ω–∏–º–∏ –∫–ª—é—á–∞–º–∏

**1.3.1 Person_id —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞**
- **–û–ø–∏—Å–∞–Ω–∏–µ:** `person_id` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ `people`
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** `person_id=NULL`, `verified=false`, `recognition_confidence=NULL`
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

**1.3.2 Photo_id —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ —Ñ–æ—Ç–æ**
- **–û–ø–∏—Å–∞–Ω–∏–µ:** `photo_id` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ `gallery_images`
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å –∏–∑ `photo_faces`
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

#### 1.4. –ü—Ä–æ–±–ª–µ–º—ã —Å –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞–º–∏

**1.4.1 –õ–∏—Ü–æ –±–µ–∑ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞**
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ù–µ—Ç –∑–∞–ø–∏—Å–∏ –≤ `face_descriptors` –¥–ª—è –ª–∏—Ü–∞
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –ü–æ–º–µ—Ç–∏—Ç—å –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏ (FastAPI)
- **–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

**1.4.2 –ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å person_id**
- **–û–ø–∏—Å–∞–Ω–∏–µ:** `photo_faces.person_id != face_descriptors.person_id`
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç —É `photo_faces`)
- **–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

#### 1.5. –ü—Ä–æ–±–ª–µ–º—ã —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ –∫–∞—á–µ—Å—Ç–≤–∞

**1.5.1 –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç confidence (–¥–µ—Ç–µ–∫—Ü–∏—è)**
- **–û–ø–∏—Å–∞–Ω–∏–µ:** `confidence IS NULL`
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –ü–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å —á–µ—Ä–µ–∑ FastAPI
- **–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

**1.5.2 –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç blur_score**
- **–û–ø–∏—Å–∞–Ω–∏–µ:** `blur_score IS NULL`
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –ü–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å —á–µ—Ä–µ–∑ FastAPI
- **–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

---

### –ö–ê–¢–ï–ì–û–†–ò–Ø 2: Face Descriptors (–¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã –ª–∏—Ü) - 7 –ø—Ä–æ–≤–µ—Ä–æ–∫

#### 2.1. –ü—Ä–æ–±–ª–µ–º—ã —Å –≤–Ω–µ—à–Ω–∏–º–∏ –∫–ª—é—á–∞–º–∏

**2.1.1 Orphaned descriptors**
- **–û–ø–∏—Å–∞–Ω–∏–µ:** `source_image_id` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ `photo_faces`
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –£–¥–∞–ª–∏—Ç—å –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

**2.1.2 Person_id —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞**
- **–û–ø–∏—Å–∞–Ω–∏–µ:** `person_id` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ `people`
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** `person_id=NULL`
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

#### 2.2. –ü—Ä–æ–±–ª–µ–º—ã —Å –¥–∞–Ω–Ω—ã–º–∏

**2.2.1 –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –±–µ–∑ embedding**
- **–û–ø–∏—Å–∞–Ω–∏–µ:** `descriptor IS NULL`
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å
- **–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

**2.2.2 –î—É–±–ª–∏–∫–∞—Ç—ã –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤**
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ù–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–µ–π —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º `source_image_id`
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –û—Å—Ç–∞–≤–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π, —É–¥–∞–ª–∏—Ç—å –æ—Å—Ç–∞–ª—å–Ω—ã–µ
- **–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

#### 2.3. –ü—Ä–æ–±–ª–µ–º—ã —Å —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å—é

**2.3.1 –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –±–µ–∑ person_id, –Ω–æ –ª–∏—Ü–æ —Å person_id**
- **–û–ø–∏—Å–∞–Ω–∏–µ:** `face_descriptors.person_id=NULL`, –Ω–æ `photo_faces.person_id NOT NULL`
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å `face_descriptors.person_id = photo_faces.person_id`
- **–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

**2.3.2 –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Å person_id, –Ω–æ –ª–∏—Ü–æ –±–µ–∑ person_id**
- **–û–ø–∏—Å–∞–Ω–∏–µ:** `face_descriptors.person_id NOT NULL`, –Ω–æ `photo_faces.person_id=NULL`
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å `face_descriptors.person_id = NULL`
- **–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

**2.3.3 –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã –±–µ–∑ person_id (–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è)**
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–¥—Å—á–µ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤ —Å `person_id=NULL`
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è (–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è)
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

---

### –ö–ê–¢–ï–ì–û–†–ò–Ø 3: Photos (—Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏) - 3 –ø—Ä–æ–≤–µ—Ä–∫–∏

#### 3.2. –ü—Ä–æ–±–ª–µ–º—ã —Å —Ñ–∞–π–ª–∞–º–∏

**3.2.1 URL –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ Vercel Blob**
- **–û–ø–∏—Å–∞–Ω–∏–µ:** `image_url` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ Vercel Blob Storage
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å
- **–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

**3.2.2 –î—É–±–ª–∏–∫–∞—Ç—ã URL**
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ù–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–µ–π —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º `image_url`
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –£–¥–∞–ª–∏—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã
- **–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

#### 3.3. –ü—Ä–æ–±–ª–µ–º—ã —Å –≤–Ω–µ—à–Ω–∏–º–∏ –∫–ª—é—á–∞–º–∏

**3.3.1 Gallery_id —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –≥–∞–ª–µ—Ä–µ—é**
- **–û–ø–∏—Å–∞–Ω–∏–µ:** `gallery_id` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ `galleries`
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é –≥–∞–ª–µ—Ä–µ—é "–ë–µ–∑ –≥–∞–ª–µ—Ä–µ–∏"
- **–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

---

### –ö–ê–¢–ï–ì–û–†–ò–Ø 4: People (–∏–≥—Ä–æ–∫–∏) - 4 –ø—Ä–æ–≤–µ—Ä–∫–∏

**4.1.1 –ò–≥—Ä–æ–∫ –±–µ–∑ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤ (–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è)**
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ù–µ—Ç –∑–∞–ø–∏—Å–µ–π –≤ `face_descriptors` –¥–ª—è –∏–≥—Ä–æ–∫–∞
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è (–Ω–æ–≤—ã–π –∏–≥—Ä–æ–∫)
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

**4.1.2 –ò–≥—Ä–æ–∫ –±–µ–∑ –ª–∏—Ü (–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è)**
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ù–µ—Ç –∑–∞–ø–∏—Å–µ–π –≤ `photo_faces` –¥–ª—è –∏–≥—Ä–æ–∫–∞
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è (–Ω–æ–≤—ã–π –∏–≥—Ä–æ–∫)
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

**4.1.3 –î—É–±–ª–∏–∫–∞—Ç—ã –∏–º–µ–Ω (–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è)**
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ù–µ—Å–∫–æ–ª—å–∫–æ –∏–≥—Ä–æ–∫–æ–≤ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º `real_name`
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –¢–æ–ª—å–∫–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ (—É –∏–≥—Ä–æ–∫–æ–≤ –µ—Å—Ç—å –Ω–∏–∫ –≤ –¢–µ–ª–µ–≥—Ä–∞–º)
- **–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

**4.1.4 –ü—É—Å—Ç–æ–µ –∏–º—è**
- **–û–ø–∏—Å–∞–Ω–∏–µ:** `real_name IS NULL` –∏–ª–∏ `= ''`
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –ï—Å–ª–∏ –µ—Å—Ç—å —Ñ–æ—Ç–æ - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ, –µ—Å–ª–∏ –Ω–µ—Ç - —É–¥–∞–ª–µ–Ω–∏–µ
- **–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

---

### –ö–ê–¢–ï–ì–û–†–ò–Ø 5: –°–≤—è–∑–∏ –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏ - 2 –ø—Ä–æ–≤–µ—Ä–∫–∏

**5.1.1 –õ–∏—Ü–æ —Å person_id, –Ω–æ —É –∏–≥—Ä–æ–∫–∞ –Ω–µ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤**
- **–û–ø–∏—Å–∞–Ω–∏–µ:** `photo_faces.person_id NOT NULL`, –Ω–æ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π –≤ `face_descriptors` –¥–ª—è —ç—Ç–æ–≥–æ –∏–≥—Ä–æ–∫–∞
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –°–æ–∑–¥–∞—Ç—å –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä (–ø–æ–º–µ—Ç–∏—Ç—å –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏)
- **–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

**5.1.2 –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Å person_id, –Ω–æ —É –∏–≥—Ä–æ–∫–∞ –Ω–µ—Ç –ª–∏—Ü**
- **–û–ø–∏—Å–∞–Ω–∏–µ:** `face_descriptors.person_id NOT NULL`, –Ω–æ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π –≤ `photo_faces` –¥–ª—è —ç—Ç–æ–≥–æ –∏–≥—Ä–æ–∫–∞
- **–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –£–¥–∞–ª–∏—Ç—å –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã
- **–°—Ç–∞—Ç—É—Å:** ‚ùå –ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### –ü—Ä–æ–≤–µ—Ä–∫–∏
- **–í—Å–µ–≥–æ –ø—Ä–æ–≤–µ—Ä–æ–∫:** 23
- **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:** 15 (65%)
- **–ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:** 8 (35%)

### –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- **–í—Å–µ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:** 19 (4 –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ)
- **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:** 7 (37%)
- **–ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:** 12 (63%)

---

## ‚ö†Ô∏è –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫

–°–ª–µ–¥—É—é—â–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã, –Ω–æ –¥–ª—è –Ω–∏—Ö –ù–ï–¢ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:

- **1.4.1** `facesWithoutDescriptors` - –Ω–µ—Ç case –≤ `fixIntegrityIssueAction`
- **1.4.2** `inconsistentPersonIds` - –Ω–µ—Ç case –≤ `fixIntegrityIssueAction`
- **2.2.1** `withoutEmbedding` - –Ω–µ—Ç case –≤ `fixIntegrityIssueAction`
- **2.2.2** `duplicateDescriptors` - –Ω–µ—Ç case –≤ `fixIntegrityIssueAction`

### 2. –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç 8 –ø—Ä–æ–≤–µ—Ä–æ–∫ –∏–∑ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞

- **1.2.2** Recognition_confidence —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –Ω–æ person_id = NULL
- **1.5.1** –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç confidence (–¥–µ—Ç–µ–∫—Ü–∏—è)
- **1.5.2** –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç blur_score
- **2.3.1** –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –±–µ–∑ person_id, –Ω–æ –ª–∏—Ü–æ —Å person_id
- **2.3.2** –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Å person_id, –Ω–æ –ª–∏—Ü–æ –±–µ–∑ person_id
- **3.2.1** URL –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ Vercel Blob
- **3.2.2** –î—É–±–ª–∏–∫–∞—Ç—ã URL
- **3.3.1** Gallery_id —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –≥–∞–ª–µ—Ä–µ—é
- **4.1.4** –ü—É—Å—Ç–æ–µ –∏–º—è
- **5.1.1** –õ–∏—Ü–æ —Å person_id, –Ω–æ —É –∏–≥—Ä–æ–∫–∞ –Ω–µ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤
- **5.1.2** –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Å person_id, –Ω–æ —É –∏–≥—Ä–æ–∫–∞ –Ω–µ—Ç –ª–∏—Ü

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ 1.2.1 —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é

–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Å—Ç–æ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `recognition_confidence=1.0` –∏–ª–∏ `0.8`, –Ω–æ –ø–æ –ø–ª–∞–Ω—É –¥–æ–ª–∂–Ω–∞:
1. –ü–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å —á–µ—Ä–µ–∑ FastAPI
2. –ï—Å–ª–∏ < –ø–æ—Ä–æ–≥–∞ - —É–¥–∞–ª–∏—Ç—å —Å–≤—è–∑—å
3. –ï—Å–ª–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–ª—Å—è –¥—Ä—É–≥–æ–π –∏–≥—Ä–æ–∫ - –∑–∞–º–µ–Ω–∏—Ç—å

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1: –î–æ–±–∞–≤–∏—Ç—å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–ö–†–ò–¢–ò–ß–ù–û)

–î–æ–±–∞–≤–∏—Ç—å case –≤ `fixIntegrityIssueAction` –¥–ª—è:
- `facesWithoutDescriptors` - –ø–æ–º–µ—Ç–∏—Ç—å –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
- `inconsistentPersonIds` - —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å `photo_faces`
- `withoutEmbedding` - —É–¥–∞–ª–∏—Ç—å –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä
- `duplicateDescriptors` - –æ—Å—Ç–∞–≤–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π, —É–¥–∞–ª–∏—Ç—å –æ—Å—Ç–∞–ª—å–Ω—ã–µ

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2: –î–æ–±–∞–≤–∏—Ç—å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏

–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å 8 –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –∏–∑ —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Å–ø–∏—Å–∫–∞.

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3: –£–ª—É—á—à–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É 1.2.1

–î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å FastAPI –¥–ª—è –ø–µ—Ä–µ—Å—á–µ—Ç–∞ `recognition_confidence`.

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤—Å–µ—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
1. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–µ –ª–æ–º–∞—é—Ç –¥–∞–Ω–Ω—ã–µ
3. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## üìù –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

### v5.0 (31.10.2025)
- –£–¥–∞–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ `face_count` (–ø–æ–ª–µ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –ë–î)
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã —Ñ–∏–ª—å—Ç—Ä—ã `.not("...", "is", null)` –Ω–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –≤ –∫–æ–¥–µ
- –ü—Ä–æ–≤–µ–¥–µ–Ω –ø–æ–ª–Ω—ã–π –∞—É–¥–∏—Ç –≤—Å–µ—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
- –°–æ–∑–¥–∞–Ω –¥–æ–∫—É–º–µ–Ω—Ç —Å –æ—Ç—á–µ—Ç–æ–º –æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏

### v4.0
- –î–æ–±–∞–≤–ª–µ–Ω—ã –∫–Ω–æ–ø–∫–∏ "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å" –¥–ª—è –∫–∞–∂–¥–æ–π –ø—Ä–æ–±–ª–µ–º—ã
- –£–ª—É—á—à–µ–Ω UI —Å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ–º –¥–µ—Ç–∞–ª–µ–π –ø—Ä–æ–±–ª–µ–º

### v3.0
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –æ—Å–Ω–æ–≤–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –ë–î
- –î–æ–±–∞–≤–ª–µ–Ω—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- `app/admin/actions.ts` - Server Actions –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- `components/admin/database-integrity-checker.tsx` - UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- `components/admin/service-manager.tsx` - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –∞–¥–º–∏–Ω–∫—É

---

## üîß –î–µ—Ç–∞–ª—å–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### –ö–ê–¢–ï–ì–û–†–ò–Ø 1: Photo Faces

#### ‚úÖ 1.1.1 Verified faces –±–µ–∑ person_id
**–ü—Ä–æ–±–ª–µ–º–∞:** –õ–∏—Ü–æ –ø–æ–º–µ—á–µ–Ω–æ –∫–∞–∫ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω–æ–µ (`verified=true`), –Ω–æ –Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω–æ –∫ –∏–≥—Ä–æ–∫—É (`person_id=null`)

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–†–ï–ê–õ–ò–ó–û–í–ê–ù–û):**
await supabase
  .from("photo_faces")
  .update({
    verified: false,
    recognition_confidence: null
  })
  .eq("id", faceId)

**–õ–æ–≥–∏–∫–∞:** –ï—Å–ª–∏ –ª–∏—Ü–æ –Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω–æ –∫ –∏–≥—Ä–æ–∫—É, –æ–Ω–æ –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ. –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è.

---

#### ‚úÖ 1.1.2 Verified faces —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º confidence
**–ü—Ä–æ–±–ª–µ–º–∞:** –õ–∏—Ü–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ –≤—Ä—É—á–Ω—É—é (`verified=true`), –Ω–æ `recognition_confidence != 1.0`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–†–ï–ê–õ–ò–ó–û–í–ê–ù–û):**
await supabase
  .from("photo_faces")
  .update({ recognition_confidence: 1.0 })
  .eq("id", faceId)

**–õ–æ–≥–∏–∫–∞:** –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–Ω—ã–µ –≤—Ä—É—á–Ω—É—é –ª–∏—Ü–∞ –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—É—é —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å (1.0).

---

#### ‚ö†Ô∏è 1.2.1 Person_id —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –Ω–æ confidence = NULL/0
**–ü—Ä–æ–±–ª–µ–º–∞:** –õ–∏—Ü–æ –ø—Ä–∏–≤—è–∑–∞–Ω–æ –∫ –∏–≥—Ä–æ–∫—É (`person_id NOT NULL`), –Ω–æ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –∏–ª–∏ —Ä–∞–≤–Ω–∞ 0

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–ß–ê–°–¢–ò–ß–ù–û –†–ï–ê–õ–ò–ó–û–í–ê–ù–û):**

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**
await supabase
  .from("photo_faces")
  .update({
    recognition_confidence: face.verified ? 1.0 : 0.8
  })
  .eq("id", faceId)

**–ß—Ç–æ –ù–£–ñ–ù–û –¥–æ–±–∞–≤–∏—Ç—å:**
1. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –ª–∏—Ü–æ –Ω–∞ –ø–µ—Ä–µ—Å—á–µ—Ç —á–µ—Ä–µ–∑ FastAPI
2. –ü–æ–ª—É—á–∏—Ç—å –Ω–æ–≤—ã–π `recognition_confidence`
3. –ï—Å–ª–∏ `confidence < THRESHOLD` (–Ω–∞–ø—Ä–∏–º–µ—Ä, 0.7):
   - –£–¥–∞–ª–∏—Ç—å —Å–≤—è–∑—å: `person_id=NULL`, `verified=false`, `recognition_confidence=NULL`
4. –ï—Å–ª–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–ª—Å—è –¥—Ä—É–≥–æ–π –∏–≥—Ä–æ–∫:
   - –ó–∞–º–µ–Ω–∏—Ç—å: `person_id=new_person_id`, `recognition_confidence=new_confidence`
5. –ï—Å–ª–∏ –ø–æ–¥—Ç–≤–µ—Ä–¥–∏–ª—Å—è —Ç–æ—Ç –∂–µ –∏–≥—Ä–æ–∫:
   - –û–±–Ω–æ–≤–∏—Ç—å: `recognition_confidence=new_confidence`

**–ö–æ–¥ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è:**
// –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –ø–µ—Ä–µ—Å—á–µ—Ç —á–µ—Ä–µ–∑ FastAPI
const response = await fetch(`${process.env.FASTAPI_URL}/recalculate-face`, {
  method: 'POST',
  body: JSON.stringify({ face_id: faceId })
})
const { person_id: newPersonId, confidence: newConfidence } = await response.json()

if (newConfidence < 0.7) {
  // –£–¥–∞–ª–∏—Ç—å —Å–≤—è–∑—å
  await supabase.from("photo_faces").update({
    person_id: null,
    verified: false,
    recognition_confidence: null
  }).eq("id", faceId)
} else if (newPersonId !== currentPersonId) {
  // –ó–∞–º–µ–Ω–∏—Ç—å –∏–≥—Ä–æ–∫–∞
  await supabase.from("photo_faces").update({
    person_id: newPersonId,
    recognition_confidence: newConfidence,
    verified: false
  }).eq("id", faceId)
} else {
  // –û–±–Ω–æ–≤–∏—Ç—å confidence
  await supabase.from("photo_faces").update({
    recognition_confidence: newConfidence
  }).eq("id", faceId)
}

---

#### ‚ùå 1.2.2 Recognition_confidence —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –Ω–æ person_id = NULL
**–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å—Ç—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è, –Ω–æ –ª–∏—Ü–æ –Ω–µ –ø—Ä–∏–≤—è–∑–∞–Ω–æ –∫ –∏–≥—Ä–æ–∫—É

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û):**
await supabase
  .from("photo_faces")
  .update({ recognition_confidence: null })
  .eq("id", faceId)

**–õ–æ–≥–∏–∫–∞:** –ï—Å–ª–∏ –Ω–µ—Ç –ø—Ä–∏–≤—è–∑–∫–∏ –∫ –∏–≥—Ä–æ–∫—É, –Ω–µ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è.

**–ß—Ç–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ `fixIntegrityIssueAction`:**
case "confidenceWithoutPerson":
  const { data: facesToClear } = await supabase
    .from("photo_faces")
    .select("id")
    .is("person_id", null)
    .not("recognition_confidence", "is", null)
  
  if (facesToClear && facesToClear.length > 0) {
    await supabase
      .from("photo_faces")
      .update({ recognition_confidence: null })
      .in("id", facesToClear.map(f => f.id))
  }
  break

---

#### ‚úÖ 1.3.1 Person_id —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞
**–ü—Ä–æ–±–ª–µ–º–∞:** `person_id` —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –∏–≥—Ä–æ–∫–∞, –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ `people`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–†–ï–ê–õ–ò–ó–û–í–ê–ù–û):**
await supabase
  .from("photo_faces")
  .update({
    person_id: null,
    verified: false,
    recognition_confidence: null
  })
  .eq("id", faceId)

**–õ–æ–≥–∏–∫–∞:** –£–¥–∞–ª—è–µ–º –±–∏—Ç—É—é —Å—Å—ã–ª–∫—É –∏ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –ø–æ–ª—è.

---

#### ‚úÖ 1.3.2 Photo_id —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–µ —Ñ–æ—Ç–æ
**–ü—Ä–æ–±–ª–µ–º–∞:** `photo_id` —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ —Ñ–æ—Ç–æ, –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ—Ç –≤ —Ç–∞–±–ª–∏—Ü–µ `gallery_images`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–†–ï–ê–õ–ò–ó–û–í–ê–ù–û):**
await supabase
  .from("photo_faces")
  .delete()
  .eq("id", faceId)

**–õ–æ–≥–∏–∫–∞:** –ï—Å–ª–∏ —Ñ–æ—Ç–æ —É–¥–∞–ª–µ–Ω–æ, –ª–∏—Ü–æ –Ω–∞ –Ω–µ–º —Ç–æ–∂–µ –Ω–µ –∏–º–µ–µ—Ç —Å–º—ã—Å–ª–∞. –£–¥–∞–ª—è–µ–º –∑–∞–ø–∏—Å—å –ø–æ–ª–Ω–æ—Å—Ç—å—é.

---

#### ‚ùå 1.4.1 –õ–∏—Ü–æ –±–µ–∑ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞
**–ü—Ä–æ–±–ª–µ–º–∞:** –î–ª—è –ª–∏—Ü–∞ –Ω–µ—Ç –∑–∞–ø–∏—Å–∏ –≤ `face_descriptors` (–Ω–µ—Ç –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è)

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û):**

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**
1. –ü–æ–º–µ—Ç–∏—Ç—å –ª–∏—Ü–æ –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
2. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∑–∞–ø—Ä–æ—Å –≤ FastAPI –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞

**–ö–æ–¥ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è:**
case "facesWithoutDescriptors":
  const { data: facesWithoutDesc } = await supabase
    .from("photo_faces")
    .select("id, photo_id")
    .in("id", issueId.split(","))
  
  if (facesWithoutDesc && facesWithoutDesc.length > 0) {
    // –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –≤ FastAPI
    for (const face of facesWithoutDesc) {
      await fetch(`${process.env.FASTAPI_URL}/process-face`, {
        method: 'POST',
        body: JSON.stringify({
          face_id: face.id,
          photo_id: face.photo_id
        })
      })
    }
  }
  break

---

#### ‚ùå 1.4.2 –ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å person_id
**–ü—Ä–æ–±–ª–µ–º–∞:** `photo_faces.person_id != face_descriptors.person_id` –¥–ª—è –æ–¥–Ω–æ–≥–æ –ª–∏—Ü–∞

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û):**

**–õ–æ–≥–∏–∫–∞:** –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —É `photo_faces` (—ç—Ç–æ —Ç–æ, —á—Ç–æ –≤–∏–¥–∏—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)

**–ö–æ–¥ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è:**
case "inconsistentPersonIds":
  const { data: inconsistentFaces } = await supabase
    .from("photo_faces")
    .select("id, person_id")
    .in("id", issueId.split(","))
  
  if (inconsistentFaces && inconsistentFaces.length > 0) {
    for (const face of inconsistentFaces) {
      // –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Å –ª–∏—Ü–æ–º
      await supabase
        .from("face_descriptors")
        .update({ person_id: face.person_id })
        .eq("source_image_id", face.id)
    }
  }
  break

---

#### ‚ùå 1.5.1 –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç confidence (–¥–µ—Ç–µ–∫—Ü–∏—è)
**–ü—Ä–æ–±–ª–µ–º–∞:** `confidence IS NULL` - –Ω–µ—Ç –æ—Ü–µ–Ω–∫–∏ —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏ –¥–µ—Ç–µ–∫—Ü–∏–∏ –ª–∏—Ü–∞

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û):**

**–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:**
1. –û—Ç–ø—Ä–∞–≤–∏—Ç—å –ª–∏—Ü–æ –Ω–∞ –ø–µ—Ä–µ—Å—á–µ—Ç —á–µ—Ä–µ–∑ FastAPI
2. –ü–æ–ª—É—á–∏—Ç—å –Ω–æ–≤—ã–π `confidence`
3. –û–±–Ω–æ–≤–∏—Ç—å –∑–∞–ø–∏—Å—å

**–ö–æ–¥ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è:**
case "missingConfidence":
  const { data: facesWithoutConf } = await supabase
    .from("photo_faces")
    .select("id, photo_id")
    .in("id", issueId.split(","))
  
  if (facesWithoutConf && facesWithoutConf.length > 0) {
    for (const face of facesWithoutConf) {
      const response = await fetch(`${process.env.FASTAPI_URL}/recalculate-metrics`, {
        method: 'POST',
        body: JSON.stringify({
          face_id: face.id,
          photo_id: face.photo_id
        })
      })
      const { confidence, blur_score } = await response.json()
      
      await supabase
        .from("photo_faces")
        .update({ confidence, blur_score })
        .eq("id", face.id)
    }
  }
  break

---

#### ‚ùå 1.5.2 –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç blur_score
**–ü—Ä–æ–±–ª–µ–º–∞:** `blur_score IS NULL` - –Ω–µ—Ç –æ—Ü–µ–Ω–∫–∏ —Ä–∞–∑–º—ã—Ç–∏—è –ª–∏—Ü–∞

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ 1.5.1 (–ø–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å —á–µ—Ä–µ–∑ FastAPI)

---

### –ö–ê–¢–ï–ì–û–†–ò–Ø 2: Face Descriptors

#### ‚úÖ 2.1.1 Orphaned descriptors
**–ü—Ä–æ–±–ª–µ–º–∞:** `source_image_id` —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –ª–∏—Ü–æ, –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ—Ç –≤ `photo_faces`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–†–ï–ê–õ–ò–ó–û–í–ê–ù–û):**
await supabase
  .from("face_descriptors")
  .delete()
  .eq("id", descriptorId)

**–õ–æ–≥–∏–∫–∞:** –ï—Å–ª–∏ –ª–∏—Ü–∞ –Ω–µ—Ç, –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –±–µ—Å–ø–æ–ª–µ–∑–µ–Ω. –£–¥–∞–ª—è–µ–º.

---

#### ‚úÖ 2.1.2 Person_id —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –∏–≥—Ä–æ–∫–∞
**–ü—Ä–æ–±–ª–µ–º–∞:** `person_id` —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –∏–≥—Ä–æ–∫–∞, –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ—Ç –≤ `people`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–†–ï–ê–õ–ò–ó–û–í–ê–ù–û):**
await supabase
  .from("face_descriptors")
  .update({ person_id: null })
  .eq("id", descriptorId)

**–õ–æ–≥–∏–∫–∞:** –£–¥–∞–ª—è–µ–º –±–∏—Ç—É—é —Å—Å—ã–ª–∫—É, –Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä (–º–æ–∂–µ—Ç –±—ã—Ç—å –ø–æ–ª–µ–∑–µ–Ω –¥–ª—è –±—É–¥—É—â–µ–≥–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è).

---

#### ‚ùå 2.2.1 –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –±–µ–∑ embedding
**–ü—Ä–æ–±–ª–µ–º–∞:** `descriptor IS NULL` - –Ω–µ—Ç –≤–µ–∫—Ç–æ—Ä–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û):**
case "withoutEmbedding":
  const { data: descriptorsWithoutEmb } = await supabase
    .from("face_descriptors")
    .select("id")
    .is("descriptor", null)
  
  if (descriptorsWithoutEmb && descriptorsWithoutEmb.length > 0) {
    await supabase
      .from("face_descriptors")
      .delete()
      .in("id", descriptorsWithoutEmb.map(d => d.id))
  }
  break

**–õ–æ–≥–∏–∫–∞:** –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –±–µ–∑ embedding –±–µ—Å–ø–æ–ª–µ–∑–µ–Ω. –£–¥–∞–ª—è–µ–º.

---

#### ‚ùå 2.2.2 –î—É–±–ª–∏–∫–∞—Ç—ã –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–µ–π —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º `source_image_id`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û):**
case "duplicateDescriptors":
  const { data: allDescriptors } = await supabase
    .from("face_descriptors")
    .select("id, source_image_id, created_at")
    .order("created_at", { ascending: false })
  
  // –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ source_image_id
  const grouped = allDescriptors.reduce((acc, d) => {
    if (!acc[d.source_image_id]) acc[d.source_image_id] = []
    acc[d.source_image_id].push(d)
    return acc
  }, {})
  
  // –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∫—Ä–æ–º–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ
  for (const [sourceId, descriptors] of Object.entries(grouped)) {
    if (descriptors.length > 1) {
      const toDelete = descriptors.slice(1).map(d => d.id)
      await supabase
        .from("face_descriptors")
        .delete()
        .in("id", toDelete)
    }
  }
  break

**–õ–æ–≥–∏–∫–∞:** –û—Å—Ç–∞–≤–ª—è–µ–º —Å–∞–º—ã–π —Å–≤–µ–∂–∏–π –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä (–ø–æ—Å–ª–µ–¥–Ω–∏–π –ø–æ `created_at`), –æ—Å—Ç–∞–ª—å–Ω—ã–µ —É–¥–∞–ª—è–µ–º.

---

#### ‚ùå 2.3.1 –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –±–µ–∑ person_id, –Ω–æ –ª–∏—Ü–æ —Å person_id
**–ü—Ä–æ–±–ª–µ–º–∞:** `face_descriptors.person_id=NULL`, –Ω–æ `photo_faces.person_id NOT NULL`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û):**
case "descriptorWithoutPersonButFaceHas":
  const { data: descriptorsToSync } = await supabase
    .from("face_descriptors")
    .select("id, source_image_id")
    .is("person_id", null)
  
  if (descriptorsToSync && descriptorsToSync.length > 0) {
    for (const descriptor of descriptorsToSync) {
      const { data: face } = await supabase
        .from("photo_faces")
        .select("person_id")
        .eq("id", descriptor.source_image_id)
        .single()
      
      if (face && face.person_id) {
        await supabase
          .from("face_descriptors")
          .update({ person_id: face.person_id })
          .eq("id", descriptor.id)
      }
    }
  }
  break

**–õ–æ–≥–∏–∫–∞:** –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ–º `person_id` –∏–∑ `photo_faces` –≤ `face_descriptors`.

---

#### ‚ùå 2.3.2 –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Å person_id, –Ω–æ –ª–∏—Ü–æ –±–µ–∑ person_id
**–ü—Ä–æ–±–ª–µ–º–∞:** `face_descriptors.person_id NOT NULL`, –Ω–æ `photo_faces.person_id=NULL`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û):**
case "descriptorWithPersonButFaceDoesnt":
  const { data: descriptorsToClear } = await supabase
    .from("face_descriptors")
    .select("id, source_image_id")
    .not("person_id", "is", null)
  
  if (descriptorsToClear && descriptorsToClear.length > 0) {
    for (const descriptor of descriptorsToClear) {
      const { data: face } = await supabase
        .from("photo_faces")
        .select("person_id")
        .eq("id", descriptor.source_image_id)
        .single()
      
      if (face && !face.person_id) {
        await supabase
          .from("face_descriptors")
          .update({ person_id: null })
          .eq("id", descriptor.id)
      }
    }
  }
  break

**–õ–æ–≥–∏–∫–∞:** –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —É `photo_faces` - –µ—Å–ª–∏ —Ç–∞–º –Ω–µ—Ç `person_id`, —É–¥–∞–ª—è–µ–º –∏–∑ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞.

---

### –ö–ê–¢–ï–ì–û–†–ò–Ø 3: Photos

#### ‚ùå 3.2.1 URL –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ Vercel Blob
**–ü—Ä–æ–±–ª–µ–º–∞:** `image_url` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ Vercel Blob Storage

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û):**
case "nonExistentUrls":
  const { data: photos } = await supabase
    .from("gallery_images")
    .select("id, image_url")
  
  if (photos && photos.length > 0) {
    for (const photo of photos) {
      try {
        const response = await fetch(photo.image_url, { method: 'HEAD' })
        if (!response.ok) {
          // URL –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç - —É–¥–∞–ª–∏—Ç—å —Ñ–æ—Ç–æ
          await supabase
            .from("gallery_images")
            .delete()
            .eq("id", photo.id)
        }
      } catch (error) {
        // –û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ - —É–¥–∞–ª–∏—Ç—å —Ñ–æ—Ç–æ
        await supabase
          .from("gallery_images")
          .delete()
          .eq("id", photo.id)
      }
    }
  }
  break

**–õ–æ–≥–∏–∫–∞:** –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å URL —á–µ—Ä–µ–∑ HEAD –∑–∞–ø—Ä–æ—Å. –ï—Å–ª–∏ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω - —É–¥–∞–ª—è–µ–º –∑–∞–ø–∏—Å—å.

---

#### ‚ùå 3.2.2 –î—É–±–ª–∏–∫–∞—Ç—ã URL
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ—Å–∫–æ–ª—å–∫–æ –∑–∞–ø–∏—Å–µ–π —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º `image_url`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û):**
case "duplicateUrls":
  const { data: allPhotos } = await supabase
    .from("gallery_images")
    .select("id, image_url, created_at")
    .order("created_at", { ascending: false })
  
  // –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ image_url
  const grouped = allPhotos.reduce((acc, p) => {
    if (!acc[p.image_url]) acc[p.image_url] = []
    acc[p.image_url].push(p)
    return acc
  }, {})
  
  // –£–¥–∞–ª–∏—Ç—å –≤—Å–µ –∫—Ä–æ–º–µ –ø–µ—Ä–≤–æ–≥–æ
  for (const [url, photos] of Object.entries(grouped)) {
    if (photos.length > 1) {
      const toDelete = photos.slice(1).map(p => p.id)
      await supabase
        .from("gallery_images")
        .delete()
        .in("id", toDelete)
    }
  }
  break

**–õ–æ–≥–∏–∫–∞:** –û—Å—Ç–∞–≤–ª—è–µ–º —Å–∞–º—É—é —Å—Ç–∞—Ä—É—é –∑–∞–ø–∏—Å—å (–ø–µ—Ä–≤—É—é –ø–æ `created_at`), –æ—Å—Ç–∞–ª—å–Ω—ã–µ —É–¥–∞–ª—è–µ–º.

---

#### ‚ùå 3.3.1 Gallery_id —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ –Ω–µ—Å—É—â–µ—Å—Ç–≤—É—é—â—É—é –≥–∞–ª–µ—Ä–µ—é
**–ü—Ä–æ–±–ª–µ–º–∞:** `gallery_id` —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ –≥–∞–ª–µ—Ä–µ—é, –∫–æ—Ç–æ—Ä–æ–π –Ω–µ—Ç –≤ `galleries`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û):**
case "nonExistentGallery":
  // –°–æ–∑–¥–∞—Ç—å —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é –≥–∞–ª–µ—Ä–µ—é "–ë–µ–∑ –≥–∞–ª–µ—Ä–µ–∏" –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
  let { data: orphanGallery } = await supabase
    .from("galleries")
    .select("id")
    .eq("name", "–ë–µ–∑ –≥–∞–ª–µ—Ä–µ–∏")
    .single()
  
  if (!orphanGallery) {
    const { data: newGallery } = await supabase
      .from("galleries")
      .insert({ name: "–ë–µ–∑ –≥–∞–ª–µ—Ä–µ–∏", description: "–§–æ—Ç–æ –±–µ–∑ –≥–∞–ª–µ—Ä–µ–∏" })
      .select()
      .single()
    orphanGallery = newGallery
  }
  
  // –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å —Ñ–æ—Ç–æ –≤ —ç—Ç—É –≥–∞–ª–µ—Ä–µ—é
  const { data: orphanPhotos } = await supabase
    .from("gallery_images")
    .select("id, gallery_id")
  
  if (orphanPhotos && orphanPhotos.length > 0) {
    for (const photo of orphanPhotos) {
      const { data: gallery } = await supabase
        .from("galleries")
        .select("id")
        .eq("id", photo.gallery_id)
        .single()
      
      if (!gallery) {
        await supabase
          .from("gallery_images")
          .update({ gallery_id: orphanGallery.id })
          .eq("id", photo.id)
      }
    }
  }
  break

**–õ–æ–≥–∏–∫–∞:** –°–æ–∑–¥–∞–µ–º —Å–ø–µ—Ü–∏–∞–ª—å–Ω—É—é –≥–∞–ª–µ—Ä–µ—é "–ë–µ–∑ –≥–∞–ª–µ—Ä–µ–∏" –∏ –ø–µ—Ä–µ–º–µ—â–∞–µ–º —Ç—É–¥–∞ —Ñ–æ—Ç–æ —Å –±–∏—Ç—ã–º–∏ —Å—Å—ã–ª–∫–∞–º–∏.

---

### –ö–ê–¢–ï–ì–û–†–ò–Ø 4: People

#### ‚ùå 4.1.4 –ü—É—Å—Ç–æ–µ –∏–º—è
**–ü—Ä–æ–±–ª–µ–º–∞:** `real_name IS NULL` –∏–ª–∏ `= ''`

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û):**
case "emptyNames":
  const { data: peopleWithEmptyNames } = await supabase
    .from("people")
    .select("id")
    .or("real_name.is.null,real_name.eq.")
  
  if (peopleWithEmptyNames && peopleWithEmptyNames.length > 0) {
    for (const person of peopleWithEmptyNames) {
      // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –µ—Å—Ç—å –ª–∏ —É –∏–≥—Ä–æ–∫–∞ —Ñ–æ—Ç–æ
      const { count } = await supabase
        .from("photo_faces")
        .select("id", { count: "exact", head: true })
        .eq("person_id", person.id)
      
      if (count === 0) {
        // –ù–µ—Ç —Ñ–æ—Ç–æ - —É–¥–∞–ª–∏—Ç—å –∏–≥—Ä–æ–∫–∞
        await supabase
          .from("people")
          .delete()
          .eq("id", person.id)
      }
      // –ï—Å–ª–∏ –µ—Å—Ç—å —Ñ–æ—Ç–æ - —Ç–æ–ª—å–∫–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ (–Ω–µ —É–¥–∞–ª—è–µ–º)
    }
  }
  break

**–õ–æ–≥–∏–∫–∞:** –ï—Å–ª–∏ —É –∏–≥—Ä–æ–∫–∞ —Å –ø—É—Å—Ç—ã–º –∏–º–µ–Ω–µ–º –Ω–µ—Ç —Ñ–æ—Ç–æ - —É–¥–∞–ª—è–µ–º. –ï—Å–ª–∏ –µ—Å—Ç—å —Ñ–æ—Ç–æ - –æ—Å—Ç–∞–≤–ª—è–µ–º (–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ).

---

### –ö–ê–¢–ï–ì–û–†–ò–Ø 5: Relations

#### ‚ùå 5.1.1 –õ–∏—Ü–æ —Å person_id, –Ω–æ —É –∏–≥—Ä–æ–∫–∞ –Ω–µ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤
**–ü—Ä–æ–±–ª–µ–º–∞:** `photo_faces.person_id NOT NULL`, –Ω–æ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π –≤ `face_descriptors` –¥–ª—è —ç—Ç–æ–≥–æ –∏–≥—Ä–æ–∫–∞

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û):**
case "faceWithPersonButNoDescriptors":
  const { data: facesWithoutDesc } = await supabase
    .from("photo_faces")
    .select("id, person_id, photo_id")
    .not("person_id", "is", null)
  
  if (facesWithoutDesc && facesWithoutDesc.length > 0) {
    for (const face of facesWithoutDesc) {
      // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –µ—Å—Ç—å –ª–∏ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã —É –∏–≥—Ä–æ–∫–∞
      const { count } = await supabase
        .from("face_descriptors")
        .select("id", { count: "exact", head: true })
        .eq("person_id", face.person_id)
      
      if (count === 0) {
        // –ù–µ—Ç –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤ - —Å–æ–∑–¥–∞—Ç—å (–æ—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É)
        await fetch(`${process.env.FASTAPI_URL}/process-face`, {
          method: 'POST',
          body: JSON.stringify({
            face_id: face.id,
            photo_id: face.photo_id,
            person_id: face.person_id
          })
        })
      }
    }
  }
  break

**–õ–æ–≥–∏–∫–∞:** –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –ª–∏—Ü–æ –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É –≤ FastAPI –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞.

---

#### ‚ùå 5.1.2 –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Å person_id, –Ω–æ —É –∏–≥—Ä–æ–∫–∞ –Ω–µ—Ç –ª–∏—Ü
**–ü—Ä–æ–±–ª–µ–º–∞:** `face_descriptors.person_id NOT NULL`, –Ω–æ –Ω–µ—Ç –∑–∞–ø–∏—Å–µ–π –≤ `photo_faces` –¥–ª—è —ç—Ç–æ–≥–æ –∏–≥—Ä–æ–∫–∞

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–ù–ï –†–ï–ê–õ–ò–ó–û–í–ê–ù–û):**
case "descriptorWithPersonButNoFaces":
  const { data: descriptorsWithoutFaces } = await supabase
    .from("face_descriptors")
    .select("id, person_id")
    .not("person_id", "is", null)
  
  if (descriptorsWithoutFaces && descriptorsWithoutFaces.length > 0) {
    for (const descriptor of descriptorsWithoutFaces) {
      // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –µ—Å—Ç—å –ª–∏ –ª–∏—Ü–∞ —É –∏–≥—Ä–æ–∫–∞
      const { count } = await supabase
        .from("photo_faces")
        .select("id", { count: "exact", head: true })
        .eq("person_id", descriptor.person_id)
      
      if (count === 0) {
        // –ù–µ—Ç –ª–∏—Ü - —É–¥–∞–ª–∏—Ç—å –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä
        await supabase
          .from("face_descriptors")
          .delete()
          .eq("id", descriptor.id)
      }
    }
  }
  break

**–õ–æ–≥–∏–∫–∞:** –ï—Å–ª–∏ —É –∏–≥—Ä–æ–∫–∞ –Ω–µ—Ç –ª–∏—Ü, –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä—ã –±–µ—Å–ø–æ–ª–µ–∑–Ω—ã. –£–¥–∞–ª—è–µ–º.

---

## üìä –°–≤–æ–¥–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

| ID | –ü—Ä–æ–≤–µ—Ä–∫–∞ | –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ | –°—Ç–∞—Ç—É—Å | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç |
|----|----------|-------------|--------|-----------|
| 1.1.1 | Verified –±–µ–∑ person_id | –°–±—Ä–æ—Å–∏—Ç—å verified | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | - |
| 1.1.2 | Verified —Å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–º confidence | –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å 1.0 | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | - |
| 1.2.1 | Person_id –±–µ–∑ confidence | –ü–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å —á–µ—Ä–µ–∑ FastAPI | ‚ö†Ô∏è –ß–∞—Å—Ç–∏—á–Ω–æ | üî¥ –í—ã—Å–æ–∫–∏–π |
| 1.2.2 | Confidence –±–µ–∑ person_id | –û–±–Ω—É–ª–∏—Ç—å confidence | ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | üü° –°—Ä–µ–¥–Ω–∏–π |
| 1.3.1 | –ù–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π person_id | –û–±–Ω—É–ª–∏—Ç—å —Å–≤—è–∑—å | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | - |
| 1.3.2 | –ù–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π photo_id | –£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | - |
| 1.4.1 | –õ–∏—Ü–æ –±–µ–∑ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–∞ | –û—Ç–ø—Ä–∞–≤–∏—Ç—å –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É | ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | üî¥ –í—ã—Å–æ–∫–∏–π |
| 1.4.2 | –ù–µ—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç—å person_id | –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å | ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | üî¥ –í—ã—Å–æ–∫–∏–π |
| 1.5.1 | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç confidence | –ü–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å —á–µ—Ä–µ–∑ FastAPI | ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | üü° –°—Ä–µ–¥–Ω–∏–π |
| 1.5.2 | –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç blur_score | –ü–µ—Ä–µ—Å—á–∏—Ç–∞—Ç—å —á–µ—Ä–µ–∑ FastAPI | ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | üü¢ –ù–∏–∑–∫–∏–π |
| 2.1.1 | Orphaned descriptors | –£–¥–∞–ª–∏—Ç—å –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | - |
| 2.1.2 | –ù–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π person_id | –û–±–Ω—É–ª–∏—Ç—å person_id | ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | - |
| 2.2.1 | –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –±–µ–∑ embedding | –£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å | ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | üî¥ –í—ã—Å–æ–∫–∏–π |
| 2.2.2 | –î—É–±–ª–∏–∫–∞—Ç—ã –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤ | –û—Å—Ç–∞–≤–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–π | ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | üü° –°—Ä–µ–¥–Ω–∏–π |
| 2.3.1 | –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –±–µ–∑ person_id | –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å | ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | üü° –°—Ä–µ–¥–Ω–∏–π |
| 2.3.2 | –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä —Å person_id | –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞—Ç—å | ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | üü° –°—Ä–µ–¥–Ω–∏–π |
| 3.2.1 | URL –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç | –£–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å—å | ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | üü° –°—Ä–µ–¥–Ω–∏–π |
| 3.2.2 | –î—É–±–ª–∏–∫–∞—Ç—ã URL | –û—Å—Ç–∞–≤–∏—Ç—å –ø–µ—Ä–≤—ã–π | ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | üü¢ –ù–∏–∑–∫–∏–π |
| 3.3.1 | –ù–µ—Å—É—â–µ—Å—Ç–≤—É—é—â–∞—è –≥–∞–ª–µ—Ä–µ—è | –ü–µ—Ä–µ–º–µ—Å—Ç–∏—Ç—å –≤ "–ë–µ–∑ –≥–∞–ª–µ—Ä–µ–∏" | ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | üü¢ –ù–∏–∑–∫–∏–π |
| 4.1.4 | –ü—É—Å—Ç–æ–µ –∏–º—è | –£–¥–∞–ª–∏—Ç—å –µ—Å–ª–∏ –Ω–µ—Ç —Ñ–æ—Ç–æ | ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | üü¢ –ù–∏–∑–∫–∏–π |
| 5.1.1 | –õ–∏—Ü–æ –±–µ–∑ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤ –∏–≥—Ä–æ–∫–∞ | –°–æ–∑–¥–∞—Ç—å –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä | ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | üü° –°—Ä–µ–¥–Ω–∏–π |
| 5.1.2 | –î–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä –±–µ–∑ –ª–∏—Ü –∏–≥—Ä–æ–∫–∞ | –£–¥–∞–ª–∏—Ç—å –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä | ‚ùå –ù–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ | üü¢ –ù–∏–∑–∫–∏–π |

---

## üéØ –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### –≠—Ç–∞–ø 1: –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (üî¥ –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

1. **1.2.1** - –î–æ–±–∞–≤–∏—Ç—å –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é —Å FastAPI –¥–ª—è –ø–µ—Ä–µ—Å—á–µ—Ç–∞ confidence
2. **1.4.1** - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –æ—Ç–ø—Ä–∞–≤–∫—É –ª–∏—Ü –Ω–∞ –æ–±—Ä–∞–±–æ—Ç–∫—É
3. **1.4.2** - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é person_id
4. **2.2.1** - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —É–¥–∞–ª–µ–Ω–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤ –±–µ–∑ embedding

### –≠—Ç–∞–ø 2: –°—Ä–µ–¥–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (üü° –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

5. **1.2.2** - –û–±–Ω—É–ª–µ–Ω–∏–µ confidence –±–µ–∑ person_id
6. **1.5.1** - –ü–µ—Ä–µ—Å—á–µ—Ç confidence –¥–µ—Ç–µ–∫—Ü–∏–∏
7. **2.2.2** - –£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤
8. **2.3.1, 2.3.2** - –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è person_id –º–µ–∂–¥—É —Ç–∞–±–ª–∏—Ü–∞–º–∏
9. **3.2.1** - –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è URL
10. **5.1.1** - –°–æ–∑–¥–∞–Ω–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤ –¥–ª—è –ª–∏—Ü

### –≠—Ç–∞–ø 3: –ù–∏–∑–∫–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (üü¢ –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

11. **1.5.2** - –ü–µ—Ä–µ—Å—á–µ—Ç blur_score
12. **3.2.2** - –£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ URL
13. **3.3.1** - –ü–µ—Ä–µ–º–µ—â–µ–Ω–∏–µ –≤ –≥–∞–ª–µ—Ä–µ—é "–ë–µ–∑ –≥–∞–ª–µ—Ä–µ–∏"
14. **4.1.4** - –£–¥–∞–ª–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤ —Å –ø—É—Å—Ç—ã–º –∏–º–µ–Ω–µ–º
15. **5.1.2** - –£–¥–∞–ª–µ–Ω–∏–µ –¥–µ—Å–∫—Ä–∏–ø—Ç–æ—Ä–æ–≤ –±–µ–∑ –ª–∏—Ü

---
